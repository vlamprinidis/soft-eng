/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Output, EventEmitter, ElementRef, HostListener } from '@angular/core';
import { Utilities } from './utilities';
import { SliderHandlerEnum } from './slider-handler.enum';
var NpnSliderComponent = /** @class */ (function (_super) {
    tslib_1.__extends(NpnSliderComponent, _super);
    function NpnSliderComponent(el) {
        var _this = _super.call(this) || this;
        _this.el = el;
        _this.sliderModel = [0, 0, 0];
        _this.step = 1;
        _this.sliderWidth = 0;
        _this.totalDiff = 0;
        _this.startClientX = 0;
        _this.startPleft = 0;
        _this.startPRight = 0;
        _this.sliderInitiated = false;
        _this.initValues = [];
        _this.currentValues = [0, 0];
        _this.handlerX = [0, 0];
        _this.isHandlerActive = false;
        _this.isTouchEventStart = false;
        _this.isMouseEventStart = false;
        _this.currentHandlerIndex = 0;
        _this.stepIndicatorPositions = [];
        _this.isDisabled = false;
        _this.hideTooltip = false;
        _this.hideValues = false;
        _this.handlerIndex = SliderHandlerEnum;
        _this.showStepIndicator = false;
        _this.multiRange = true;
        _this.onChange = new EventEmitter();
        return _this;
    }
    Object.defineProperty(NpnSliderComponent.prototype, "setMinValues", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (!isNaN(value)) {
                this.minValue = Number(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NpnSliderComponent.prototype, "setMaxValues", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (!isNaN(value)) {
                this.maxValue = Number(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NpnSliderComponent.prototype, "setMinSelectedValues", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (!isNaN(value) && this.minSelected !== Number(value)) {
                this.minSelected = Number(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NpnSliderComponent.prototype, "setMaxSelectedValues", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (!isNaN(value) && this.maxSelected !== Number(value)) {
                this.maxSelected = Number(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NpnSliderComponent.prototype, "stepValue", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (!isNaN(value)) {
                this.step = Number(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NpnSliderComponent.prototype, "setHideTooltip", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this.hideTooltip = this.toBoolean(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NpnSliderComponent.prototype, "setHideValues", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this.hideValues = this.toBoolean(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NpnSliderComponent.prototype, "setDisabled", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this.isDisabled = this.toBoolean(value, 'disabled');
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NpnSliderComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.initializeSlider();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    NpnSliderComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (this.sliderInitiated) {
            if (!this.isNullOrEmpty(changes["setMinSelectedValues"])
                && changes["setMinSelectedValues"].previousValue === changes["setMinSelectedValues"].currentValue) {
                return;
            }
            if (!this.isNullOrEmpty(changes["setMaxSelectedValues"])
                && changes["setMaxSelectedValues"].previousValue === changes["setMaxSelectedValues"].currentValue) {
                return;
            }
            this.resetModel();
        }
    };
    /**
     * @return {?}
     */
    NpnSliderComponent.prototype.initializeSlider = /**
     * @return {?}
     */
    function () {
        try {
            // Taking width of slider bar element.
            this.sliderWidth = this.el.nativeElement.children[0].children[0].offsetWidth;
            this.resetModel();
            this.sliderInitiated = true;
        }
        catch (/** @type {?} */ e) {
            console.error(e);
        }
    };
    /**
     * @return {?}
     */
    NpnSliderComponent.prototype.resetModel = /**
     * @return {?}
     */
    function () {
        this.validateSliderValues();
        // Setting the model values
        this.sliderModel = [
            this.currentValues[0] - this.initValues[0],
            this.currentValues[1] - this.currentValues[0],
            this.initValues[1] - this.currentValues[1]
        ];
        this.totalDiff = this.sliderModel.reduce(function (prevValue, curValue) { return prevValue + curValue; }, 0);
        // Validation for slider step
        if (this.totalDiff % this.step !== 0) {
            var /** @type {?} */ newStep = this.findNextValidStepValue(this.totalDiff, this.step);
            console.warn('Invalid step value "' + this.step + '" : and took "' + newStep + '" as default step');
            this.step = newStep;
        }
        this.initializeStepIndicator();
        this.setHandlerPosition();
    };
    /**
     * @return {?}
     */
    NpnSliderComponent.prototype.validateSliderValues = /**
     * @return {?}
     */
    function () {
        if (this.isNullOrEmpty(this.minValue) || this.isNullOrEmpty(this.maxValue)) {
            this.updateInitValues([0, 0]);
            this.updateCurrentValue([0, 0], true);
        }
        else if (this.minValue > this.maxValue) {
            this.updateInitValues([0, 0]);
            this.updateCurrentValue([0, 0], true);
        }
        else {
            this.initValues = [this.minValue, this.maxValue];
            /*
                  * Validation for Selected range values
                  */
            this.minSelected = this.isNullOrEmpty(this.minSelected) ? 0 : this.minSelected;
            this.maxSelected = this.isNullOrEmpty(this.maxSelected) ? 0 : this.maxSelected;
            if (this.minSelected < this.minValue || this.minSelected > this.maxValue) {
                this.minSelected = this.minValue;
            }
            if (this.maxSelected < this.minValue || this.maxSelected > this.maxValue) {
                this.maxSelected = this.maxValue;
            }
            if (this.minSelected > this.maxSelected) {
                this.minSelected = this.minValue;
                this.maxSelected = this.maxValue;
            }
            this.updateCurrentValue([this.minSelected, this.maxSelected], true);
        }
    };
    /**
     * @return {?}
     */
    NpnSliderComponent.prototype.initializeStepIndicator = /**
     * @return {?}
     */
    function () {
        if (this.showStepIndicator) {
            this.stepIndicatorPositions.length = 0;
            var /** @type {?} */ numOfStepIndicators = this.totalDiff / this.step;
            if (this.sliderWidth / numOfStepIndicators >= 10) {
                var /** @type {?} */ increment = this.sliderWidth / numOfStepIndicators;
                var /** @type {?} */ leftPosition = increment;
                while (this.stepIndicatorPositions.length < numOfStepIndicators - 1) {
                    this.stepIndicatorPositions.push(+leftPosition.toFixed(2));
                    leftPosition += increment;
                }
            }
            else {
                console.warn("As 'step' value is too small compared to min & max value difference and slider width,\n          Step Indicator can't be displayed!. Provide slight large value for 'step'");
            }
        }
        else {
            this.stepIndicatorPositions.length = 0;
        }
    };
    /**
     * @param {?} arrayValue
     * @param {?=} privateChange
     * @return {?}
     */
    NpnSliderComponent.prototype.updateCurrentValue = /**
     * @param {?} arrayValue
     * @param {?=} privateChange
     * @return {?}
     */
    function (arrayValue, privateChange) {
        if (privateChange === void 0) { privateChange = false; }
        this.minSelected = this.currentValues[0] = arrayValue[0];
        this.maxSelected = this.currentValues[1] = arrayValue[1];
        if (!privateChange) {
            this.onChange.emit((this.multiRange) ? this.currentValues : [this.currentValues[0]]);
        }
    };
    /**
     * @param {?} arrayValue
     * @return {?}
     */
    NpnSliderComponent.prototype.updateInitValues = /**
     * @param {?} arrayValue
     * @return {?}
     */
    function (arrayValue) {
        this.minValue = this.initValues[0] = arrayValue[0];
        this.maxValue = this.initValues[1] = arrayValue[1];
    };
    /**
     * @return {?}
     */
    NpnSliderComponent.prototype.setHandlerPosition = /**
     * @return {?}
     */
    function () {
        var /** @type {?} */ runningTotal = 0;
        // Updating selected values : current values
        this.updateCurrentValue([
            this.initValues[0] + this.sliderModel[0],
            this.initValues[1] - this.sliderModel[2]
        ]);
        /*Setting handler position */
        for (var /** @type {?} */ i = 0, /** @type {?} */ len = this.sliderModel.length - 1; i < len; i++) {
            runningTotal += this.sliderModel[i];
            this.handlerX[i] = (runningTotal / this.totalDiff) * 100;
        }
    };
    /**
     * @param {?} index
     * @param {?} value
     * @return {?}
     */
    NpnSliderComponent.prototype.setModelValue = /**
     * @param {?} index
     * @param {?} value
     * @return {?}
     */
    function (index, value) {
        if (this.step > 1) {
            value = Math.round(value / this.step) * this.step;
        }
        this.sliderModel[index] = value;
    };
    /*Method to disable handler movement*/
    /*Execute on events:
    * on-mouseup
    * on-panend
    */
    /**
     * @return {?}
     */
    NpnSliderComponent.prototype.setHandlerActiveOff = /**
     * @return {?}
     */
    function () {
        this.isMouseEventStart = false;
        this.isTouchEventStart = false;
        this.isHandlerActive = false;
    };
    /**
     * @param {?} event
     * @param {?} handlerIndex
     * @return {?}
     */
    NpnSliderComponent.prototype.setHandlerActive = /**
     * @param {?} event
     * @param {?} handlerIndex
     * @return {?}
     */
    function (event, handlerIndex) {
        event.preventDefault();
        if (!this.isDisabled) {
            if (!this.isNullOrEmpty(event.clientX)) {
                this.startClientX = event.clientX;
                this.isMouseEventStart = true;
                this.isTouchEventStart = false;
            }
            else if (!this.isNullOrEmpty(event.deltaX)) {
                this.startClientX = event.deltaX;
                this.isTouchEventStart = true;
                this.isMouseEventStart = false;
            }
            if (this.isMouseEventStart || this.isTouchEventStart) {
                this.currentHandlerIndex = handlerIndex;
                this.startPleft = this.sliderModel[handlerIndex];
                this.startPRight = this.sliderModel[handlerIndex + 1];
                this.isHandlerActive = true;
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NpnSliderComponent.prototype.handlerSliding = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if ((this.isMouseEventStart && event.clientX) || (this.isTouchEventStart && event.deltaX)) {
            var /** @type {?} */ movedX = Math.round(((event.clientX || event.deltaX) - this.startClientX) / this.sliderWidth * this.totalDiff);
            var /** @type {?} */ nextPLeft = this.startPleft + movedX;
            var /** @type {?} */ nextPRight = this.startPRight - movedX;
            if (nextPLeft >= 0 && nextPRight >= 0) {
                this.setModelValue(this.currentHandlerIndex, nextPLeft);
                this.setModelValue(this.currentHandlerIndex + 1, nextPRight);
                this.setHandlerPosition();
            }
        }
    };
    NpnSliderComponent.decorators = [
        { type: Component, args: [{
                    selector: 'npn-slider',
                    template: "<!--npn-slider template-->\n<div class=\"slider\" [class.disabled]=\"isDisabled\">\n  <div class=\"bar\" (mousemove)=\"handlerSliding($event)\" (panmove)=\"handlerSliding($event)\">\n    <span class=\"left-handle\" [ngClass]=\"{'active': isHandlerActive && currentHandlerIndex === handlerIndex.left,\n                      'last-active': currentHandlerIndex === handlerIndex.left\n                    }\"\n      [style.left.%]=\"handlerX[handlerIndex.left]\" (mousedown)=\"setHandlerActive($event, handlerIndex.left)\" (panstart)=\"setHandlerActive($event, handlerIndex.left)\">\n      <span *ngIf=\"!hideTooltip\" class=\"handle-tooltip\">{{currentValues[handlerIndex.left]}}</span>\n    </span>\n    <div class=\"filler\">\n      <div class=\"step-indicators\">\n        <span *ngFor=\"let stepPos of stepIndicatorPositions\" [style.left.px]=\"stepPos\"></span>\n      </div>\n      <span *ngIf=\"multiRange\" [style.left.%]=\"handlerX[0]\" [style.width.%]=\"handlerX[handlerIndex.right] - handlerX[handlerIndex.left]\"></span>\n      <span *ngIf=\"!multiRange\" [style.left.%]=\"0\" [style.width.%]=\"handlerX[0]\"></span>\n    </div>\n    <span *ngIf=\"multiRange\" class=\"right-handle\" [ngClass]=\"{'active': isHandlerActive && currentHandlerIndex === handlerIndex.right,\n                      'last-active': currentHandlerIndex === handlerIndex.right\n                    }\"\n      [style.left.%]=\"handlerX[handlerIndex.right]\" (mousedown)=\"setHandlerActive($event, handlerIndex.right)\"\n      (panstart)=\"setHandlerActive($event, handlerIndex.right)\">\n      <span *ngIf=\"!hideTooltip\" class=\"handle-tooltip\">{{currentValues[handlerIndex.right]}}</span>\n    </span>\n  </div>\n  <div class=\"values\" *ngIf=\"!hideValues\">\n    <span>{{initValues[handlerIndex.left]}}</span>\n    <span>{{initValues[handlerIndex.right]}}</span>\n  </div>\n</div>\n",
                    styles: [".slider,.slider *{box-sizing:border-box}.slider{display:block;width:100%;height:30px;padding:4px 10px;cursor:default;font-size:12px}.slider .bar{width:100%;background:#e8e8e8;height:10px;position:relative;border-radius:5px;box-shadow:inset 1px 1px 5px #bababa}.slider .bar>span.left-handle,.slider .bar>span.right-handle{display:inline-block;width:22px;height:22px;background:#bedcb2;border:7px solid #71b357;border-radius:50%;position:absolute;top:-7px;margin-left:-10px;z-index:1;cursor:pointer;transition:left .2s ease}.slider .bar>span.left-handle.last-active,.slider .bar>span.right-handle.last-active{z-index:2}.slider .bar>span.left-handle .handle-tooltip,.slider .bar>span.right-handle .handle-tooltip{display:block;position:absolute;top:-34px;left:-14px;border:1px solid #8fc37a;border-radius:4px;padding:1px 4px;min-width:20px;text-align:center;background:#d9ebd2;color:#71b357;font-weight:700;transition:opacity .2s ease;opacity:0}.slider .bar>span.left-handle .handle-tooltip:before,.slider .bar>span.right-handle .handle-tooltip:before{content:\"\";border:5px solid transparent;border-top-color:#8fc37a;position:absolute;top:104%;left:33%}.slider .bar>span.left-handle .handle-tooltip:after,.slider .bar>span.right-handle .handle-tooltip:after{content:\"\";border:5px solid transparent;border-top-color:#d9ebd2;position:absolute;top:100%;left:33%}.slider .bar>span.left-handle.active>.handle-tooltip,.slider .bar>span.left-handle:hover>.handle-tooltip,.slider .bar>span.right-handle.active>.handle-tooltip,.slider .bar>span.right-handle:hover>.handle-tooltip{opacity:1}.slider .bar div.filler{display:block;width:100%;height:100%;position:relative;overflow:hidden;border-radius:5px;border:1px solid #bedcb2}.slider .bar div.filler>span{display:inline-block;height:100%;position:absolute;top:0;background:#bedcb2;transition:all .2s ease}.slider .bar div.filler>div.step-indicators{width:100%;height:100%;position:relative}.slider .bar div.filler>div.step-indicators>span{width:1px;display:inline-block;height:10px;background:#71b357;position:absolute;left:0}.slider .values{display:block;font-weight:700;margin-top:4px;width:102%;margin-left:-1%;color:#908f90}.slider .values span:first-child{float:left}.slider .values span:last-child{float:right}.slider.disabled{opacity:.4}.slider.disabled .bar{box-shadow:none!important}.slider.disabled .bar>span.left-handle,.slider.disabled .bar>span.right-handle{cursor:not-allowed}.slider.disabled .bar>span.left-handle .handle-tooltip,.slider.disabled .bar>span.right-handle .handle-tooltip{display:none}"]
                },] },
    ];
    /** @nocollapse */
    NpnSliderComponent.ctorParameters = function () { return [
        { type: ElementRef }
    ]; };
    NpnSliderComponent.propDecorators = {
        setMinValues: [{ type: Input, args: ['min',] }],
        setMaxValues: [{ type: Input, args: ['max',] }],
        setMinSelectedValues: [{ type: Input, args: ['minSelected',] }],
        setMaxSelectedValues: [{ type: Input, args: ['maxSelected',] }],
        stepValue: [{ type: Input, args: ['step',] }],
        showStepIndicator: [{ type: Input }],
        multiRange: [{ type: Input }],
        setHideTooltip: [{ type: Input, args: ['hide-tooltip',] }],
        setHideValues: [{ type: Input, args: ['hide-values',] }],
        setDisabled: [{ type: Input, args: ['disabled',] }],
        onChange: [{ type: Output }],
        setHandlerActiveOff: [{ type: HostListener, args: ['document:mouseup',] }, { type: HostListener, args: ['document:panend',] }]
    };
    return NpnSliderComponent;
}(Utilities));
export { NpnSliderComponent };
function NpnSliderComponent_tsickle_Closure_declarations() {
    /** @type {?} */
    NpnSliderComponent.prototype.sliderModel;
    /** @type {?} */
    NpnSliderComponent.prototype.step;
    /** @type {?} */
    NpnSliderComponent.prototype.sliderWidth;
    /** @type {?} */
    NpnSliderComponent.prototype.totalDiff;
    /** @type {?} */
    NpnSliderComponent.prototype.startClientX;
    /** @type {?} */
    NpnSliderComponent.prototype.startPleft;
    /** @type {?} */
    NpnSliderComponent.prototype.startPRight;
    /** @type {?} */
    NpnSliderComponent.prototype.minValue;
    /** @type {?} */
    NpnSliderComponent.prototype.maxValue;
    /** @type {?} */
    NpnSliderComponent.prototype.minSelected;
    /** @type {?} */
    NpnSliderComponent.prototype.maxSelected;
    /** @type {?} */
    NpnSliderComponent.prototype.sliderInitiated;
    /** @type {?} */
    NpnSliderComponent.prototype.initValues;
    /** @type {?} */
    NpnSliderComponent.prototype.currentValues;
    /** @type {?} */
    NpnSliderComponent.prototype.handlerX;
    /** @type {?} */
    NpnSliderComponent.prototype.isHandlerActive;
    /** @type {?} */
    NpnSliderComponent.prototype.isTouchEventStart;
    /** @type {?} */
    NpnSliderComponent.prototype.isMouseEventStart;
    /** @type {?} */
    NpnSliderComponent.prototype.currentHandlerIndex;
    /** @type {?} */
    NpnSliderComponent.prototype.stepIndicatorPositions;
    /** @type {?} */
    NpnSliderComponent.prototype.isDisabled;
    /** @type {?} */
    NpnSliderComponent.prototype.hideTooltip;
    /** @type {?} */
    NpnSliderComponent.prototype.hideValues;
    /** @type {?} */
    NpnSliderComponent.prototype.handlerIndex;
    /** @type {?} */
    NpnSliderComponent.prototype.showStepIndicator;
    /** @type {?} */
    NpnSliderComponent.prototype.multiRange;
    /** @type {?} */
    NpnSliderComponent.prototype.onChange;
    /** @type {?} */
    NpnSliderComponent.prototype.el;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnBuLXNsaWRlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9ucG4tc2xpZGVyLyIsInNvdXJjZXMiOlsibGliL25wbi1zbGlkZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFDdEMsVUFBVSxFQUFVLFlBQVksRUFDakMsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUN4QyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQzs7SUFvQ2xCLDhDQUFTO0lBNEIvQyw0QkFBb0IsRUFBYztRQUFsQyxZQUNFLGlCQUFPLFNBQ1I7UUFGbUIsUUFBRSxHQUFGLEVBQUUsQ0FBWTs0QkEzQlosQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztxQkFDaEIsQ0FBQzs0QkFDTSxDQUFDOzBCQUNILENBQUM7NkJBQ0UsQ0FBQzsyQkFDSCxDQUFDOzRCQUNBLENBQUM7Z0NBS0csS0FBSzsyQkFFRCxFQUFFOzhCQUNDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQzt5QkFDWCxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7Z0NBQ1QsS0FBSztrQ0FDSCxLQUFLO2tDQUNMLEtBQUs7b0NBQ0gsQ0FBQzt1Q0FDRSxFQUFFOzJCQUNkLEtBQUs7NEJBQ0osS0FBSzsyQkFDTixLQUFLOzZCQUVILGlCQUFpQjtrQ0F3Q1YsS0FBSzsyQkFDWixJQUFJO3lCQWVMLElBQUksWUFBWSxFQUFZOztLQXBEaEQ7SUFFRCxzQkFDSSw0Q0FBWTs7Ozs7UUFEaEIsVUFDaUIsS0FBYTtZQUM1QixFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ2xCLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxD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VUFBVTs7OytCQXVFVCxLQUFLLFNBQUMsS0FBSzsrQkFPWCxLQUFLLFNBQUMsS0FBSzt1Q0FPWCxLQUFLLFNBQUMsYUFBYTt1Q0FPbkIsS0FBSyxTQUFDLGFBQWE7NEJBTW5CLEtBQUssU0FBQyxNQUFNO29DQU9aLEtBQUs7NkJBQ0wsS0FBSztpQ0FDTCxLQUFLLFNBQUMsY0FBYztnQ0FJcEIsS0FBSyxTQUFDLGFBQWE7OEJBS25CLEtBQUssU0FBQyxVQUFVOzJCQUtoQixNQUFNO3NDQW9KTixZQUFZLFNBQUMsa0JBQWtCLGNBQy9CLFlBQVksU0FBQyxpQkFBaUI7OzZCQWhSakM7RUF5Q3dDLFNBQVM7U0FBcEMsa0JBQWtCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBDb21wb25lbnQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlcixcclxuICBFbGVtZW50UmVmLCBPbkluaXQsIEhvc3RMaXN0ZW5lciwgU2ltcGxlQ2hhbmdlcywgT25DaGFuZ2VzXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFV0aWxpdGllcyB9IGZyb20gJy4vdXRpbGl0aWVzJztcclxuaW1wb3J0IHsgU2xpZGVySGFuZGxlckVudW0gfSBmcm9tICcuL3NsaWRlci1oYW5kbGVyLmVudW0nO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICducG4tc2xpZGVyJyxcclxuICB0ZW1wbGF0ZTogYDwhLS1ucG4tc2xpZGVyIHRlbXBsYXRlLS0+XHJcbjxkaXYgY2xhc3M9XCJzbGlkZXJcIiBbY2xhc3MuZGlzYWJsZWRdPVwiaXNEaXNhYmxlZFwiPlxyXG4gIDxkaXYgY2xhc3M9XCJiYXJcIiAobW91c2Vtb3ZlKT1cImhhbmRsZXJTbGlkaW5nKCRldmVudClcIiAocGFubW92ZSk9XCJoYW5kbGVyU2xpZGluZygkZXZlbnQpXCI+XHJcbiAgICA8c3BhbiBjbGFzcz1cImxlZnQtaGFuZGxlXCIgW25nQ2xhc3NdPVwieydhY3RpdmUnOiBpc0hhbmRsZXJBY3RpdmUgJiYgY3VycmVudEhhbmRsZXJJbmRleCA9PT0gaGFuZGxlckluZGV4LmxlZnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAnbGFzdC1hY3RpdmUnOiBjdXJyZW50SGFuZGxlckluZGV4ID09PSBoYW5kbGVySW5kZXgubGVmdFxyXG4gICAgICAgICAgICAgICAgICAgIH1cIlxyXG4gICAgICBbc3R5bGUubGVmdC4lXT1cImhhbmRsZXJYW2hhbmRsZXJJbmRleC5sZWZ0XVwiIChtb3VzZWRvd24pPVwic2V0SGFuZGxlckFjdGl2ZSgkZXZlbnQsIGhhbmRsZXJJbmRleC5sZWZ0KVwiIChwYW5zdGFydCk9XCJzZXRIYW5kbGVyQWN0aXZlKCRldmVudCwgaGFuZGxlckluZGV4LmxlZnQpXCI+XHJcbiAgICAgIDxzcGFuICpuZ0lmPVwiIWhpZGVUb29sdGlwXCIgY2xhc3M9XCJoYW5kbGUtdG9vbHRpcFwiPnt7Y3VycmVudFZhbHVlc1toYW5kbGVySW5kZXgubGVmdF19fTwvc3Bhbj5cclxuICAgIDwvc3Bhbj5cclxuICAgIDxkaXYgY2xhc3M9XCJmaWxsZXJcIj5cclxuICAgICAgPGRpdiBjbGFzcz1cInN0ZXAtaW5kaWNhdG9yc1wiPlxyXG4gICAgICAgIDxzcGFuICpuZ0Zvcj1cImxldCBzdGVwUG9zIG9mIHN0ZXBJbmRpY2F0b3JQb3NpdGlvbnNcIiBbc3R5bGUubGVmdC5weF09XCJzdGVwUG9zXCI+PC9zcGFuPlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPHNwYW4gKm5nSWY9XCJtdWx0aVJhbmdlXCIgW3N0eWxlLmxlZnQuJV09XCJoYW5kbGVyWFswXVwiIFtzdHlsZS53aWR0aC4lXT1cImhhbmRsZXJYW2hhbmRsZXJJbmRleC5yaWdodF0gLSBoYW5kbGVyWFtoYW5kbGVySW5kZXgubGVmdF1cIj48L3NwYW4+XHJcbiAgICAgIDxzcGFuICpuZ0lmPVwiIW11bHRpUmFuZ2VcIiBbc3R5bGUubGVmdC4lXT1cIjBcIiBbc3R5bGUud2lkdGguJV09XCJoYW5kbGVyWFswXVwiPjwvc3Bhbj5cclxuICAgIDwvZGl2PlxyXG4gICAgPHNwYW4gKm5nSWY9XCJtdWx0aVJhbmdlXCIgY2xhc3M9XCJyaWdodC1oYW5kbGVcIiBbbmdDbGFzc109XCJ7J2FjdGl2ZSc6IGlzSGFuZGxlckFjdGl2ZSAmJiBjdXJyZW50SGFuZGxlckluZGV4ID09PSBoYW5kbGVySW5kZXgucmlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAnbGFzdC1hY3RpdmUnOiBjdXJyZW50SGFuZGxlckluZGV4ID09PSBoYW5kbGVySW5kZXgucmlnaHRcclxuICAgICAgICAgICAgICAgICAgICB9XCJcclxuICAgICAgW3N0eWxlLmxlZnQuJV09XCJoYW5kbGVyWFtoYW5kbGVySW5kZXgucmlnaHRdXCIgKG1vdXNlZG93bik9XCJzZXRIYW5kbGVyQWN0aXZlKCRldmVudCwgaGFuZGxlckluZGV4LnJpZ2h0KVwiXHJcbiAgICAgIChwYW5zdGFydCk9XCJzZXRIYW5kbGVyQWN0aXZlKCRldmVudCwgaGFuZGxlckluZGV4LnJpZ2h0KVwiPlxyXG4gICAgICA8c3BhbiAqbmdJZj1cIiFoaWRlVG9vbHRpcFwiIGNsYXNzPVwiaGFuZGxlLXRvb2x0aXBcIj57e2N1cnJlbnRWYWx1ZXNbaGFuZGxlckluZGV4LnJpZ2h0XX19PC9zcGFuPlxyXG4gICAgPC9zcGFuPlxyXG4gIDwvZGl2PlxyXG4gIDxkaXYgY2xhc3M9XCJ2YWx1ZXNcIiAqbmdJZj1cIiFoaWRlVmFsdWVzXCI+XHJcbiAgICA8c3Bhbj57e2luaXRWYWx1ZXNbaGFuZGxlckluZGV4LmxlZnRdfX08L3NwYW4+XHJcbiAgICA8c3Bhbj57e2luaXRWYWx1ZXNbaGFuZGxlckluZGV4LnJpZ2h0XX19PC9zcGFuPlxyXG4gIDwvZGl2PlxyXG48L2Rpdj5cclxuYCxcclxuICBzdHlsZXM6IFtgLnNsaWRlciwuc2xpZGVyICp7Ym94LXNpemluZzpib3JkZXItYm94fS5zbGlkZXJ7ZGlzcGxheTpibG9jazt3aWR0aDoxMDAlO2hlaWdodDozMHB4O3BhZGRpbmc6NHB4IDEwcHg7Y3Vyc29yOmRlZmF1bHQ7Zm9udC1zaXplOjEycHh9LnNsaWRlciAuYmFye3dpZHRoOjEwMCU7YmFja2dyb3VuZDojZThlOGU4O2hlaWdodDoxMHB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JvcmRlci1yYWRpdXM6NXB4O2JveC1zaGFkb3c6aW5zZXQgMXB4IDFweCA1cHggI2JhYmFiYX0uc2xpZGVyIC5iYXI+c3Bhbi5sZWZ0LWhhbmRsZSwuc2xpZGVyIC5iYXI+c3Bhbi5yaWdodC1oYW5kbGV7ZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6MjJweDtoZWlnaHQ6MjJweDtiYWNrZ3JvdW5kOiNiZWRjYjI7Ym9yZGVyOjdweCBzb2xpZCAjNzFiMzU3O2JvcmRlci1yYWRpdXM6NTAlO3Bvc2l0aW9uOmFic29sdXRlO3RvcDotN3B4O21hcmdpbi1sZWZ0Oi0xMHB4O3otaW5kZXg6MTtjdXJzb3I6cG9pbnRlcjt0cmFuc2l0aW9uOmxlZnQgLjJzIGVhc2V9LnNsaWRlciAuYmFyPnNwYW4ubGVmdC1oYW5kbGUubGFzdC1hY3RpdmUsLnNsaWRlciAuYmFyPnNwYW4ucmlnaHQtaGFuZGxlLmxhc3QtYWN0aXZle3otaW5kZXg6Mn0uc2xpZGVyIC5iYXI+c3Bhbi5sZWZ0LWhhbmRsZSAuaGFuZGxlLXRvb2x0aXAsLnNsaWRlciAuYmFyPnNwYW4ucmlnaHQtaGFuZGxlIC5oYW5kbGUtdG9vbHRpcHtkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO3RvcDotMzRweDtsZWZ0Oi0xNHB4O2JvcmRlcjoxcHggc29saWQgIzhmYzM3YTtib3JkZXItcmFkaXVzOjRweDtwYWRkaW5nOjFweCA0cHg7bWluLXdpZHRoOjIwcHg7dGV4dC1hbGlnbjpjZW50ZXI7YmFja2dyb3VuZDojZDllYmQyO2NvbG9yOiM3MWIzNTc7Zm9udC13ZWlnaHQ6NzAwO3RyYW5zaXRpb246b3BhY2l0eSAuMnMgZWFzZTtvcGFjaXR5OjB9LnNsaWRlciAuYmFyPnNwYW4ubGVmdC1oYW5kbGUgLmhhbmRsZS10b29sdGlwOmJlZm9yZSwuc2xpZGVyIC5iYXI+c3Bhbi5yaWdodC1oYW5kbGUgLmhhbmRsZS10b29sdGlwOmJlZm9yZXtjb250ZW50OlwiXCI7Ym9yZGVyOjVweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItdG9wLWNvbG9yOiM4ZmMzN2E7cG9zaXRpb246YWJzb2x1dGU7dG9wOjEwNCU7bGVmdDozMyV9LnNsaWRlciAuYmFyPnNwYW4ubGVmdC1oYW5kbGUgLmhhbmRsZS10b29sdGlwOmFmdGVyLC5zbGlkZXIgLmJhcj5zcGFuLnJpZ2h0LWhhbmRsZSAuaGFuZGxlLXRvb2x0aXA6YWZ0ZXJ7Y29udGVudDpcIlwiO2JvcmRlcjo1cHggc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLXRvcC1jb2xvcjojZDllYmQyO3Bvc2l0aW9uOmFic29sdXRlO3RvcDoxMDAlO2xlZnQ6MzMlfS5zbGlkZXIgLmJhcj5zcGFuLmxlZnQtaGFuZGxlLmFjdGl2ZT4uaGFuZGxlLXRvb2x0aXAsLnNsaWRlciAuYmFyPnNwYW4ubGVmdC1oYW5kbGU6aG92ZXI+LmhhbmRsZS10b29sdGlwLC5zbGlkZXIgLmJhcj5zcGFuLnJpZ2h0LWhhbmRsZS5hY3RpdmU+LmhhbmRsZS10b29sdGlwLC5zbGlkZXIgLmJhcj5zcGFuLnJpZ2h0LWhhbmRsZTpob3Zlcj4uaGFuZGxlLXRvb2x0aXB7b3BhY2l0eToxfS5zbGlkZXIgLmJhciBkaXYuZmlsbGVye2Rpc3BsYXk6YmxvY2s7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW47Ym9yZGVyLXJhZGl1czo1cHg7Ym9yZGVyOjFweCBzb2xpZCAjYmVkY2IyfS5zbGlkZXIgLmJhciBkaXYuZmlsbGVyPnNwYW57ZGlzcGxheTppbmxpbmUtYmxvY2s7aGVpZ2h0OjEwMCU7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7YmFja2dyb3VuZDojYmVkY2IyO3RyYW5zaXRpb246YWxsIC4ycyBlYXNlfS5zbGlkZXIgLmJhciBkaXYuZmlsbGVyPmRpdi5zdGVwLWluZGljYXRvcnN7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtwb3NpdGlvbjpyZWxhdGl2ZX0uc2xpZGVyIC5iYXIgZGl2LmZpbGxlcj5kaXYuc3RlcC1pbmRpY2F0b3JzPnNwYW57d2lkdGg6MXB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO2hlaWdodDoxMHB4O2JhY2tncm91bmQ6IzcxYjM1Nztwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjB9LnNsaWRlciAudmFsdWVze2Rpc3BsYXk6YmxvY2s7Zm9udC13ZWlnaHQ6NzAwO21hcmdpbi10b3A6NHB4O3dpZHRoOjEwMiU7bWFyZ2luLWxlZnQ6LTElO2NvbG9yOiM5MDhmOTB9LnNsaWRlciAudmFsdWVzIHNwYW46Zmlyc3QtY2hpbGR7ZmxvYXQ6bGVmdH0uc2xpZGVyIC52YWx1ZXMgc3BhbjpsYXN0LWNoaWxke2Zsb2F0OnJpZ2h0fS5zbGlkZXIuZGlzYWJsZWR7b3BhY2l0eTouNH0uc2xpZGVyLmRpc2FibGVkIC5iYXJ7Ym94LXNoYWRvdzpub25lIWltcG9ydGFudH0uc2xpZGVyLmRpc2FibGVkIC5iYXI+c3Bhbi5sZWZ0LWhhbmRsZSwuc2xpZGVyLmRpc2FibGVkIC5iYXI+c3Bhbi5yaWdodC1oYW5kbGV7Y3Vyc29yOm5vdC1hbGxvd2VkfS5zbGlkZXIuZGlzYWJsZWQgLmJhcj5zcGFuLmxlZnQtaGFuZGxlIC5oYW5kbGUtdG9vbHRpcCwuc2xpZGVyLmRpc2FibGVkIC5iYXI+c3Bhbi5yaWdodC1oYW5kbGUgLmhhbmRsZS10b29sdGlwe2Rpc3BsYXk6bm9uZX1gXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTnBuU2xpZGVyQ29tcG9uZW50IGV4dGVuZHMgVXRpbGl0aWVzIGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG4gIHByaXZhdGUgc2xpZGVyTW9kZWwgPSBbMCwgMCwgMF07XHJcbiAgcHJpdmF0ZSBzdGVwID0gMTtcclxuICBwcml2YXRlIHNsaWRlcldpZHRoID0gMDtcclxuICBwcml2YXRlIHRvdGFsRGlmZiA9IDA7XHJcbiAgcHJpdmF0ZSBzdGFydENsaWVudFggPSAwO1xyXG4gIHByaXZhdGUgc3RhcnRQbGVmdCA9IDA7XHJcbiAgcHJpdmF0ZSBzdGFydFBSaWdodCA9IDA7XHJcbiAgcHJpdmF0ZSBtaW5WYWx1ZTogbnVtYmVyO1xyXG4gIHByaXZhdGUgbWF4VmFsdWU6IG51bWJlcjtcclxuICBwcml2YXRlIG1pblNlbGVjdGVkOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBtYXhTZWxlY3RlZDogbnVtYmVyO1xyXG4gIHByaXZhdGUgc2xpZGVySW5pdGlhdGVkID0gZmFsc2U7XHJcblxyXG4gIHB1YmxpYyBpbml0VmFsdWVzOiBudW1iZXJbXSA9IFtdO1xyXG4gIHB1YmxpYyBjdXJyZW50VmFsdWVzOiBudW1iZXJbXSA9IFswLCAwXTtcclxuICBwdWJsaWMgaGFuZGxlclg6IG51bWJlcltdID0gWzAsIDBdO1xyXG4gIHB1YmxpYyBpc0hhbmRsZXJBY3RpdmUgPSBmYWxzZTtcclxuICBwdWJsaWMgaXNUb3VjaEV2ZW50U3RhcnQgPSBmYWxzZTtcclxuICBwdWJsaWMgaXNNb3VzZUV2ZW50U3RhcnQgPSBmYWxzZTtcclxuICBwdWJsaWMgY3VycmVudEhhbmRsZXJJbmRleCA9IDA7XHJcbiAgcHVibGljIHN0ZXBJbmRpY2F0b3JQb3NpdGlvbnMgPSBbXTtcclxuICBwdWJsaWMgaXNEaXNhYmxlZCA9IGZhbHNlO1xyXG4gIHB1YmxpYyBoaWRlVG9vbHRpcCA9IGZhbHNlO1xyXG4gIHB1YmxpYyBoaWRlVmFsdWVzID0gZmFsc2U7XHJcblxyXG4gIHB1YmxpYyBoYW5kbGVySW5kZXggPSBTbGlkZXJIYW5kbGVyRW51bTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBlbDogRWxlbWVudFJlZikge1xyXG4gICAgc3VwZXIoKTtcclxuICB9XHJcblxyXG4gIEBJbnB1dCgnbWluJylcclxuICBzZXQgc2V0TWluVmFsdWVzKHZhbHVlOiBudW1iZXIpIHtcclxuICAgIGlmICghaXNOYU4odmFsdWUpKSB7XHJcbiAgICAgIHRoaXMubWluVmFsdWUgPSBOdW1iZXIodmFsdWUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQElucHV0KCdtYXgnKVxyXG4gIHNldCBzZXRNYXhWYWx1ZXModmFsdWU6IG51bWJlcikge1xyXG4gICAgaWYgKCFpc05hTih2YWx1ZSkpIHtcclxuICAgICAgdGhpcy5tYXhWYWx1ZSA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBASW5wdXQoJ21pblNlbGVjdGVkJylcclxuICBzZXQgc2V0TWluU2VsZWN0ZWRWYWx1ZXModmFsdWU6IG51bWJlcikge1xyXG4gICAgaWYgKCFpc05hTih2YWx1ZSkgJiYgdGhpcy5taW5TZWxlY3RlZCAhPT0gTnVtYmVyKHZhbHVlKSkge1xyXG4gICAgICB0aGlzLm1pblNlbGVjdGVkID0gTnVtYmVyKHZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBJbnB1dCgnbWF4U2VsZWN0ZWQnKVxyXG4gIHNldCBzZXRNYXhTZWxlY3RlZFZhbHVlcyh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICBpZiAoIWlzTmFOKHZhbHVlKSAmJiB0aGlzLm1heFNlbGVjdGVkICE9PSBOdW1iZXIodmFsdWUpKSB7XHJcbiAgICAgIHRoaXMubWF4U2VsZWN0ZWQgPSBOdW1iZXIodmFsdWUpO1xyXG4gICAgfVxyXG4gIH1cclxuICBASW5wdXQoJ3N0ZXAnKVxyXG4gIHNldCBzdGVwVmFsdWUodmFsdWU6IG51bWJlcikge1xyXG4gICAgaWYgKCFpc05hTih2YWx1ZSkpIHtcclxuICAgICAgdGhpcy5zdGVwID0gTnVtYmVyKHZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBJbnB1dCgpIHNob3dTdGVwSW5kaWNhdG9yID0gZmFsc2U7XHJcbiAgQElucHV0KCkgbXVsdGlSYW5nZSA9IHRydWU7XHJcbiAgQElucHV0KCdoaWRlLXRvb2x0aXAnKVxyXG4gIHNldCBzZXRIaWRlVG9vbHRpcCh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgdGhpcy5oaWRlVG9vbHRpcCA9IHRoaXMudG9Cb29sZWFuKHZhbHVlKTtcclxuICB9XHJcbiAgQElucHV0KCdoaWRlLXZhbHVlcycpXHJcbiAgc2V0IHNldEhpZGVWYWx1ZXModmFsdWU6IGJvb2xlYW4pIHtcclxuICAgIHRoaXMuaGlkZVZhbHVlcyA9IHRoaXMudG9Cb29sZWFuKHZhbHVlKTtcclxuICB9XHJcblxyXG4gIEBJbnB1dCgnZGlzYWJsZWQnKVxyXG4gIHNldCBzZXREaXNhYmxlZCh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmlzRGlzYWJsZWQgPSB0aGlzLnRvQm9vbGVhbih2YWx1ZSwgJ2Rpc2FibGVkJyk7XHJcbiAgfVxyXG5cclxuICBAT3V0cHV0KCkgb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPG51bWJlcltdPigpO1xyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZVNsaWRlcigpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgaWYgKHRoaXMuc2xpZGVySW5pdGlhdGVkKSB7XHJcbiAgICAgIGlmICghdGhpcy5pc051bGxPckVtcHR5KGNoYW5nZXMuc2V0TWluU2VsZWN0ZWRWYWx1ZXMpXHJcbiAgICAgICAgJiYgY2hhbmdlcy5zZXRNaW5TZWxlY3RlZFZhbHVlcy5wcmV2aW91c1ZhbHVlID09PSBjaGFuZ2VzLnNldE1pblNlbGVjdGVkVmFsdWVzLmN1cnJlbnRWYWx1ZSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIXRoaXMuaXNOdWxsT3JFbXB0eShjaGFuZ2VzLnNldE1heFNlbGVjdGVkVmFsdWVzKVxyXG4gICAgICAgICYmIGNoYW5nZXMuc2V0TWF4U2VsZWN0ZWRWYWx1ZXMucHJldmlvdXNWYWx1ZSA9PT0gY2hhbmdlcy5zZXRNYXhTZWxlY3RlZFZhbHVlcy5jdXJyZW50VmFsdWUpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5yZXNldE1vZGVsKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKk1ldGhvZCB0byBpbml0YWlsaXplIGVudGlyZSBTbGlkZXIqL1xyXG4gIHB1YmxpYyBpbml0aWFsaXplU2xpZGVyKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVGFraW5nIHdpZHRoIG9mIHNsaWRlciBiYXIgZWxlbWVudC5cclxuICAgICAgdGhpcy5zbGlkZXJXaWR0aCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5jaGlsZHJlblswXS5jaGlsZHJlblswXS5vZmZzZXRXaWR0aDtcclxuICAgICAgdGhpcy5yZXNldE1vZGVsKCk7XHJcbiAgICAgIHRoaXMuc2xpZGVySW5pdGlhdGVkID0gdHJ1ZTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIGluaXRpYWxpemUgdmFyaWFibGVzIGFuZCBtb2RlbCB2YWx1ZXMgKi9cclxuICBwcml2YXRlIHJlc2V0TW9kZWwoKSB7XHJcbiAgICB0aGlzLnZhbGlkYXRlU2xpZGVyVmFsdWVzKCk7XHJcbiAgICAvLyBTZXR0aW5nIHRoZSBtb2RlbCB2YWx1ZXNcclxuICAgIHRoaXMuc2xpZGVyTW9kZWwgPSBbXHJcbiAgICAgIHRoaXMuY3VycmVudFZhbHVlc1swXSAtIHRoaXMuaW5pdFZhbHVlc1swXSxcclxuICAgICAgdGhpcy5jdXJyZW50VmFsdWVzWzFdIC0gdGhpcy5jdXJyZW50VmFsdWVzWzBdLFxyXG4gICAgICB0aGlzLmluaXRWYWx1ZXNbMV0gLSB0aGlzLmN1cnJlbnRWYWx1ZXNbMV1cclxuICAgIF07XHJcblxyXG4gICAgdGhpcy50b3RhbERpZmYgPSB0aGlzLnNsaWRlck1vZGVsLnJlZHVjZSgocHJldlZhbHVlLCBjdXJWYWx1ZSkgPT4gcHJldlZhbHVlICsgY3VyVmFsdWUsIDApO1xyXG5cclxuICAgIC8vIFZhbGlkYXRpb24gZm9yIHNsaWRlciBzdGVwXHJcbiAgICBpZiAodGhpcy50b3RhbERpZmYgJSB0aGlzLnN0ZXAgIT09IDApIHtcclxuICAgICAgY29uc3QgbmV3U3RlcCA9IHRoaXMuZmluZE5leHRWYWxpZFN0ZXBWYWx1ZSh0aGlzLnRvdGFsRGlmZiwgdGhpcy5zdGVwKTtcclxuICAgICAgY29uc29sZS53YXJuKCdJbnZhbGlkIHN0ZXAgdmFsdWUgXCInICsgdGhpcy5zdGVwICsgJ1wiIDogYW5kIHRvb2sgXCInICsgbmV3U3RlcCArICdcIiBhcyBkZWZhdWx0IHN0ZXAnKTtcclxuICAgICAgdGhpcy5zdGVwID0gbmV3U3RlcDtcclxuICAgIH1cclxuICAgIHRoaXMuaW5pdGlhbGl6ZVN0ZXBJbmRpY2F0b3IoKTtcclxuICAgIHRoaXMuc2V0SGFuZGxlclBvc2l0aW9uKCk7XHJcbiAgfVxyXG5cclxuICAvKk1ldGhvZCB0byBkbyB2YWxpZGF0aW9uIG9mIGluaXQgYW5kIHNlbGV0ZWQgcmFuZ2UgdmFsdWVzKi9cclxuICBwcml2YXRlIHZhbGlkYXRlU2xpZGVyVmFsdWVzKCkge1xyXG4gICAgaWYgKHRoaXMuaXNOdWxsT3JFbXB0eSh0aGlzLm1pblZhbHVlKSB8fCB0aGlzLmlzTnVsbE9yRW1wdHkodGhpcy5tYXhWYWx1ZSkpIHtcclxuICAgICAgdGhpcy51cGRhdGVJbml0VmFsdWVzKFswLCAwXSk7XHJcbiAgICAgIHRoaXMudXBkYXRlQ3VycmVudFZhbHVlKFswLCAwXSwgdHJ1ZSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMubWluVmFsdWUgPiB0aGlzLm1heFZhbHVlKSB7XHJcbiAgICAgIHRoaXMudXBkYXRlSW5pdFZhbHVlcyhbMCwgMF0pO1xyXG4gICAgICB0aGlzLnVwZGF0ZUN1cnJlbnRWYWx1ZShbMCwgMF0sIHRydWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5pbml0VmFsdWVzID0gW3RoaXMubWluVmFsdWUsIHRoaXMubWF4VmFsdWVdO1xyXG4gICAgICAvKlxyXG4gICAgICAqIFZhbGlkYXRpb24gZm9yIFNlbGVjdGVkIHJhbmdlIHZhbHVlc1xyXG4gICAgICAqL1xyXG4gICAgICB0aGlzLm1pblNlbGVjdGVkID0gdGhpcy5pc051bGxPckVtcHR5KHRoaXMubWluU2VsZWN0ZWQpID8gMCA6IHRoaXMubWluU2VsZWN0ZWQ7XHJcbiAgICAgIHRoaXMubWF4U2VsZWN0ZWQgPSB0aGlzLmlzTnVsbE9yRW1wdHkodGhpcy5tYXhTZWxlY3RlZCkgPyAwIDogdGhpcy5tYXhTZWxlY3RlZDtcclxuXHJcbiAgICAgIGlmICh0aGlzLm1pblNlbGVjdGVkIDwgdGhpcy5taW5WYWx1ZSB8fCB0aGlzLm1pblNlbGVjdGVkID4gdGhpcy5tYXhWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMubWluU2VsZWN0ZWQgPSB0aGlzLm1pblZhbHVlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1heFNlbGVjdGVkIDwgdGhpcy5taW5WYWx1ZSB8fCB0aGlzLm1heFNlbGVjdGVkID4gdGhpcy5tYXhWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMubWF4U2VsZWN0ZWQgPSB0aGlzLm1heFZhbHVlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1pblNlbGVjdGVkID4gdGhpcy5tYXhTZWxlY3RlZCkge1xyXG4gICAgICAgIHRoaXMubWluU2VsZWN0ZWQgPSB0aGlzLm1pblZhbHVlO1xyXG4gICAgICAgIHRoaXMubWF4U2VsZWN0ZWQgPSB0aGlzLm1heFZhbHVlO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMudXBkYXRlQ3VycmVudFZhbHVlKFt0aGlzLm1pblNlbGVjdGVkLCB0aGlzLm1heFNlbGVjdGVkXSwgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKk1ldGhvZCB0byBhZGQgc3RlcCBpbmlkaWNhdG9yIHRvIHNsaWRlciAqL1xyXG4gIHByaXZhdGUgaW5pdGlhbGl6ZVN0ZXBJbmRpY2F0b3IoKSB7XHJcbiAgICBpZiAodGhpcy5zaG93U3RlcEluZGljYXRvcikge1xyXG4gICAgICB0aGlzLnN0ZXBJbmRpY2F0b3JQb3NpdGlvbnMubGVuZ3RoID0gMDtcclxuICAgICAgY29uc3QgbnVtT2ZTdGVwSW5kaWNhdG9ycyA9IHRoaXMudG90YWxEaWZmIC8gdGhpcy5zdGVwO1xyXG4gICAgICBpZiAodGhpcy5zbGlkZXJXaWR0aCAvIG51bU9mU3RlcEluZGljYXRvcnMgPj0gMTApIHtcclxuICAgICAgICBjb25zdCBpbmNyZW1lbnQgPSB0aGlzLnNsaWRlcldpZHRoIC8gbnVtT2ZTdGVwSW5kaWNhdG9ycztcclxuICAgICAgICBsZXQgbGVmdFBvc2l0aW9uID0gaW5jcmVtZW50O1xyXG4gICAgICAgIHdoaWxlICh0aGlzLnN0ZXBJbmRpY2F0b3JQb3NpdGlvbnMubGVuZ3RoIDwgbnVtT2ZTdGVwSW5kaWNhdG9ycyAtIDEpIHtcclxuICAgICAgICAgIHRoaXMuc3RlcEluZGljYXRvclBvc2l0aW9ucy5wdXNoKCtsZWZ0UG9zaXRpb24udG9GaXhlZCgyKSk7XHJcbiAgICAgICAgICBsZWZ0UG9zaXRpb24gKz0gaW5jcmVtZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYEFzICdzdGVwJyB2YWx1ZSBpcyB0b28gc21hbGwgY29tcGFyZWQgdG8gbWluICYgbWF4IHZhbHVlIGRpZmZlcmVuY2UgYW5kIHNsaWRlciB3aWR0aCxcclxuICAgICAgICAgIFN0ZXAgSW5kaWNhdG9yIGNhbid0IGJlIGRpc3BsYXllZCEuIFByb3ZpZGUgc2xpZ2h0IGxhcmdlIHZhbHVlIGZvciAnc3RlcCdgKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5zdGVwSW5kaWNhdG9yUG9zaXRpb25zLmxlbmd0aCA9IDA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKk1ldGhvZCB0byBzZXQgY3VycmVudCBzZWxlY3RlZCB2YWx1ZXMgKi9cclxuICBwcml2YXRlIHVwZGF0ZUN1cnJlbnRWYWx1ZShhcnJheVZhbHVlOiBudW1iZXJbXSwgcHJpdmF0ZUNoYW5nZTogYm9vbGVhbiA9IGZhbHNlKSB7XHJcbiAgICB0aGlzLm1pblNlbGVjdGVkID0gdGhpcy5jdXJyZW50VmFsdWVzWzBdID0gYXJyYXlWYWx1ZVswXTtcclxuICAgIHRoaXMubWF4U2VsZWN0ZWQgPSB0aGlzLmN1cnJlbnRWYWx1ZXNbMV0gPSBhcnJheVZhbHVlWzFdO1xyXG4gICAgaWYgKCFwcml2YXRlQ2hhbmdlKSB7XHJcbiAgICAgIHRoaXMub25DaGFuZ2UuZW1pdCgodGhpcy5tdWx0aVJhbmdlKSA/IHRoaXMuY3VycmVudFZhbHVlcyA6IFt0aGlzLmN1cnJlbnRWYWx1ZXNbMF1dKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIHNldCBjdXJyZW50IHNlbGVjdGVkIHZhbHVlcyAqL1xyXG4gIHByaXZhdGUgdXBkYXRlSW5pdFZhbHVlcyhhcnJheVZhbHVlOiBudW1iZXJbXSkge1xyXG4gICAgdGhpcy5taW5WYWx1ZSA9IHRoaXMuaW5pdFZhbHVlc1swXSA9IGFycmF5VmFsdWVbMF07XHJcbiAgICB0aGlzLm1heFZhbHVlID0gdGhpcy5pbml0VmFsdWVzWzFdID0gYXJyYXlWYWx1ZVsxXTtcclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIHNldCBoYW5kbGVyIHBvc2l0aW9uICovXHJcbiAgcHJpdmF0ZSBzZXRIYW5kbGVyUG9zaXRpb24oKSB7XHJcbiAgICBsZXQgcnVubmluZ1RvdGFsID0gMDtcclxuICAgIC8vIFVwZGF0aW5nIHNlbGVjdGVkIHZhbHVlcyA6IGN1cnJlbnQgdmFsdWVzXHJcbiAgICB0aGlzLnVwZGF0ZUN1cnJlbnRWYWx1ZShbXHJcbiAgICAgIHRoaXMuaW5pdFZhbHVlc1swXSArIHRoaXMuc2xpZGVyTW9kZWxbMF0sXHJcbiAgICAgIHRoaXMuaW5pdFZhbHVlc1sxXSAtIHRoaXMuc2xpZGVyTW9kZWxbMl1cclxuICAgIF0pO1xyXG4gICAgLypTZXR0aW5nIGhhbmRsZXIgcG9zaXRpb24gKi9cclxuICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSB0aGlzLnNsaWRlck1vZGVsLmxlbmd0aCAtIDE7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICBydW5uaW5nVG90YWwgKz0gdGhpcy5zbGlkZXJNb2RlbFtpXTtcclxuICAgICAgdGhpcy5oYW5kbGVyWFtpXSA9IChydW5uaW5nVG90YWwgLyB0aGlzLnRvdGFsRGlmZikgKiAxMDA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKk1ldGhvZCB0byBzZXQgbW9kZWwgYXJyYXkgdmFsdWVzIC0gd2lsbCB0cnkgdG8gcmVmaW5lIHRoZSB2YWx1ZXMgdXNpbmcgc3RlcCAqL1xyXG4gIHByaXZhdGUgc2V0TW9kZWxWYWx1ZShpbmRleDogbnVtYmVyLCB2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICBpZiAodGhpcy5zdGVwID4gMSkge1xyXG4gICAgICB2YWx1ZSA9IE1hdGgucm91bmQodmFsdWUgLyB0aGlzLnN0ZXApICogdGhpcy5zdGVwO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zbGlkZXJNb2RlbFtpbmRleF0gPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIGRpc2FibGUgaGFuZGxlciBtb3ZlbWVudCovXHJcbiAgLypFeGVjdXRlIG9uIGV2ZW50czpcclxuICAqIG9uLW1vdXNldXBcclxuICAqIG9uLXBhbmVuZFxyXG4gICovXHJcbiAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6bW91c2V1cCcpXHJcbiAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6cGFuZW5kJylcclxuICBzZXRIYW5kbGVyQWN0aXZlT2ZmKCkge1xyXG4gICAgdGhpcy5pc01vdXNlRXZlbnRTdGFydCA9IGZhbHNlO1xyXG4gICAgdGhpcy5pc1RvdWNoRXZlbnRTdGFydCA9IGZhbHNlO1xyXG4gICAgdGhpcy5pc0hhbmRsZXJBY3RpdmUgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIGRldGVjdCBzdGFydCBkcmFnaW5nIGhhbmRsZXIqL1xyXG4gIC8qRXhlY3V0ZSBvbiBldmVudHM6XHJcbiAgKiBvbi1tb3VzZWRvd25cclxuICAqIG9uLXBhbnN0YXJ0XHJcbiAgKi9cclxuICBwdWJsaWMgc2V0SGFuZGxlckFjdGl2ZShldmVudDogYW55LCBoYW5kbGVySW5kZXg6IG51bWJlcikge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmICghdGhpcy5pc0Rpc2FibGVkKSB7XHJcblxyXG4gICAgICBpZiAoIXRoaXMuaXNOdWxsT3JFbXB0eShldmVudC5jbGllbnRYKSkge1xyXG4gICAgICAgIHRoaXMuc3RhcnRDbGllbnRYID0gZXZlbnQuY2xpZW50WDtcclxuICAgICAgICB0aGlzLmlzTW91c2VFdmVudFN0YXJ0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmlzVG91Y2hFdmVudFN0YXJ0ID0gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuaXNOdWxsT3JFbXB0eShldmVudC5kZWx0YVgpKSB7XHJcbiAgICAgICAgdGhpcy5zdGFydENsaWVudFggPSBldmVudC5kZWx0YVg7XHJcbiAgICAgICAgdGhpcy5pc1RvdWNoRXZlbnRTdGFydCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pc01vdXNlRXZlbnRTdGFydCA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmlzTW91c2VFdmVudFN0YXJ0IHx8IHRoaXMuaXNUb3VjaEV2ZW50U3RhcnQpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRIYW5kbGVySW5kZXggPSBoYW5kbGVySW5kZXg7XHJcbiAgICAgICAgdGhpcy5zdGFydFBsZWZ0ID0gdGhpcy5zbGlkZXJNb2RlbFtoYW5kbGVySW5kZXhdO1xyXG4gICAgICAgIHRoaXMuc3RhcnRQUmlnaHQgPSB0aGlzLnNsaWRlck1vZGVsW2hhbmRsZXJJbmRleCArIDFdO1xyXG4gICAgICAgIHRoaXMuaXNIYW5kbGVyQWN0aXZlID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIC8qTWV0aG9kIHRvIGNhbGN1bGF0ZSBzaWxkZXIgaGFuZGxlciBtb3ZlbWVudCAqL1xyXG4gIC8qRXhlY3V0ZSBvbiBldmVudHM6XHJcbiAgKiBvbi1tb3VzZW1vdmVcclxuICAqIG9uLXBhbm1vdmVcclxuICAqL1xyXG4gIHB1YmxpYyBoYW5kbGVyU2xpZGluZyhldmVudDogYW55KSB7XHJcbiAgICBpZiAoKHRoaXMuaXNNb3VzZUV2ZW50U3RhcnQgJiYgZXZlbnQuY2xpZW50WCkgfHwgKHRoaXMuaXNUb3VjaEV2ZW50U3RhcnQgJiYgZXZlbnQuZGVsdGFYKSkge1xyXG4gICAgICBjb25zdCBtb3ZlZFggPSBNYXRoLnJvdW5kKCgoZXZlbnQuY2xpZW50WCB8fCBldmVudC5kZWx0YVgpIC0gdGhpcy5zdGFydENsaWVudFgpIC8gdGhpcy5zbGlkZXJXaWR0aCAqIHRoaXMudG90YWxEaWZmKTtcclxuICAgICAgY29uc3QgbmV4dFBMZWZ0ID0gdGhpcy5zdGFydFBsZWZ0ICsgbW92ZWRYO1xyXG4gICAgICBjb25zdCBuZXh0UFJpZ2h0ID0gdGhpcy5zdGFydFBSaWdodCAtIG1vdmVkWDtcclxuICAgICAgaWYgKG5leHRQTGVmdCA+PSAwICYmIG5leHRQUmlnaHQgPj0gMCkge1xyXG4gICAgICAgIHRoaXMuc2V0TW9kZWxWYWx1ZSh0aGlzLmN1cnJlbnRIYW5kbGVySW5kZXgsIG5leHRQTGVmdCk7XHJcbiAgICAgICAgdGhpcy5zZXRNb2RlbFZhbHVlKHRoaXMuY3VycmVudEhhbmRsZXJJbmRleCArIDEsIG5leHRQUmlnaHQpO1xyXG4gICAgICAgIHRoaXMuc2V0SGFuZGxlclBvc2l0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19