/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ElementRef, HostListener } from '@angular/core';
import { Utilities } from './utilities';
import { SliderHandlerEnum } from './slider-handler.enum';
export class NpnSliderComponent extends Utilities {
    /**
     * @param {?} el
     */
    constructor(el) {
        super();
        this.el = el;
        this.sliderModel = [0, 0, 0];
        this.step = 1;
        this.sliderWidth = 0;
        this.totalDiff = 0;
        this.startClientX = 0;
        this.startPleft = 0;
        this.startPRight = 0;
        this.sliderInitiated = false;
        this.initValues = [];
        this.currentValues = [0, 0];
        this.handlerX = [0, 0];
        this.isHandlerActive = false;
        this.isTouchEventStart = false;
        this.isMouseEventStart = false;
        this.currentHandlerIndex = 0;
        this.stepIndicatorPositions = [];
        this.isDisabled = false;
        this.hideTooltip = false;
        this.hideValues = false;
        this.handlerIndex = SliderHandlerEnum;
        this.showStepIndicator = false;
        this.multiRange = true;
        this.onChange = new EventEmitter();
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set setMinValues(value) {
        if (!isNaN(value)) {
            this.minValue = Number(value);
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set setMaxValues(value) {
        if (!isNaN(value)) {
            this.maxValue = Number(value);
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set setMinSelectedValues(value) {
        if (!isNaN(value) && this.minSelected !== Number(value)) {
            this.minSelected = Number(value);
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set setMaxSelectedValues(value) {
        if (!isNaN(value) && this.maxSelected !== Number(value)) {
            this.maxSelected = Number(value);
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set stepValue(value) {
        if (!isNaN(value)) {
            this.step = Number(value);
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set setHideTooltip(value) {
        this.hideTooltip = this.toBoolean(value);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set setHideValues(value) {
        this.hideValues = this.toBoolean(value);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set setDisabled(value) {
        this.isDisabled = this.toBoolean(value, 'disabled');
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.initializeSlider();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (this.sliderInitiated) {
            if (!this.isNullOrEmpty(changes["setMinSelectedValues"])
                && changes["setMinSelectedValues"].previousValue === changes["setMinSelectedValues"].currentValue) {
                return;
            }
            if (!this.isNullOrEmpty(changes["setMaxSelectedValues"])
                && changes["setMaxSelectedValues"].previousValue === changes["setMaxSelectedValues"].currentValue) {
                return;
            }
            this.resetModel();
        }
    }
    /**
     * @return {?}
     */
    initializeSlider() {
        try {
            // Taking width of slider bar element.
            this.sliderWidth = this.el.nativeElement.children[0].children[0].offsetWidth;
            this.resetModel();
            this.sliderInitiated = true;
        }
        catch (/** @type {?} */ e) {
            console.error(e);
        }
    }
    /**
     * @return {?}
     */
    resetModel() {
        this.validateSliderValues();
        // Setting the model values
        this.sliderModel = [
            this.currentValues[0] - this.initValues[0],
            this.currentValues[1] - this.currentValues[0],
            this.initValues[1] - this.currentValues[1]
        ];
        this.totalDiff = this.sliderModel.reduce((prevValue, curValue) => prevValue + curValue, 0);
        // Validation for slider step
        if (this.totalDiff % this.step !== 0) {
            const /** @type {?} */ newStep = this.findNextValidStepValue(this.totalDiff, this.step);
            console.warn('Invalid step value "' + this.step + '" : and took "' + newStep + '" as default step');
            this.step = newStep;
        }
        this.initializeStepIndicator();
        this.setHandlerPosition();
    }
    /**
     * @return {?}
     */
    validateSliderValues() {
        if (this.isNullOrEmpty(this.minValue) || this.isNullOrEmpty(this.maxValue)) {
            this.updateInitValues([0, 0]);
            this.updateCurrentValue([0, 0], true);
        }
        else if (this.minValue > this.maxValue) {
            this.updateInitValues([0, 0]);
            this.updateCurrentValue([0, 0], true);
        }
        else {
            this.initValues = [this.minValue, this.maxValue];
            /*
                  * Validation for Selected range values
                  */
            this.minSelected = this.isNullOrEmpty(this.minSelected) ? 0 : this.minSelected;
            this.maxSelected = this.isNullOrEmpty(this.maxSelected) ? 0 : this.maxSelected;
            if (this.minSelected < this.minValue || this.minSelected > this.maxValue) {
                this.minSelected = this.minValue;
            }
            if (this.maxSelected < this.minValue || this.maxSelected > this.maxValue) {
                this.maxSelected = this.maxValue;
            }
            if (this.minSelected > this.maxSelected) {
                this.minSelected = this.minValue;
                this.maxSelected = this.maxValue;
            }
            this.updateCurrentValue([this.minSelected, this.maxSelected], true);
        }
    }
    /**
     * @return {?}
     */
    initializeStepIndicator() {
        if (this.showStepIndicator) {
            this.stepIndicatorPositions.length = 0;
            const /** @type {?} */ numOfStepIndicators = this.totalDiff / this.step;
            if (this.sliderWidth / numOfStepIndicators >= 10) {
                const /** @type {?} */ increment = this.sliderWidth / numOfStepIndicators;
                let /** @type {?} */ leftPosition = increment;
                while (this.stepIndicatorPositions.length < numOfStepIndicators - 1) {
                    this.stepIndicatorPositions.push(+leftPosition.toFixed(2));
                    leftPosition += increment;
                }
            }
            else {
                console.warn(`As 'step' value is too small compared to min & max value difference and slider width,
          Step Indicator can't be displayed!. Provide slight large value for 'step'`);
            }
        }
        else {
            this.stepIndicatorPositions.length = 0;
        }
    }
    /**
     * @param {?} arrayValue
     * @param {?=} privateChange
     * @return {?}
     */
    updateCurrentValue(arrayValue, privateChange = false) {
        this.minSelected = this.currentValues[0] = arrayValue[0];
        this.maxSelected = this.currentValues[1] = arrayValue[1];
        if (!privateChange) {
            this.onChange.emit((this.multiRange) ? this.currentValues : [this.currentValues[0]]);
        }
    }
    /**
     * @param {?} arrayValue
     * @return {?}
     */
    updateInitValues(arrayValue) {
        this.minValue = this.initValues[0] = arrayValue[0];
        this.maxValue = this.initValues[1] = arrayValue[1];
    }
    /**
     * @return {?}
     */
    setHandlerPosition() {
        let /** @type {?} */ runningTotal = 0;
        // Updating selected values : current values
        this.updateCurrentValue([
            this.initValues[0] + this.sliderModel[0],
            this.initValues[1] - this.sliderModel[2]
        ]);
        /*Setting handler position */
        for (let /** @type {?} */ i = 0, /** @type {?} */ len = this.sliderModel.length - 1; i < len; i++) {
            runningTotal += this.sliderModel[i];
            this.handlerX[i] = (runningTotal / this.totalDiff) * 100;
        }
    }
    /**
     * @param {?} index
     * @param {?} value
     * @return {?}
     */
    setModelValue(index, value) {
        if (this.step > 1) {
            value = Math.round(value / this.step) * this.step;
        }
        this.sliderModel[index] = value;
    }
    /**
     * @return {?}
     */
    setHandlerActiveOff() {
        this.isMouseEventStart = false;
        this.isTouchEventStart = false;
        this.isHandlerActive = false;
    }
    /**
     * @param {?} event
     * @param {?} handlerIndex
     * @return {?}
     */
    setHandlerActive(event, handlerIndex) {
        event.preventDefault();
        if (!this.isDisabled) {
            if (!this.isNullOrEmpty(event.clientX)) {
                this.startClientX = event.clientX;
                this.isMouseEventStart = true;
                this.isTouchEventStart = false;
            }
            else if (!this.isNullOrEmpty(event.deltaX)) {
                this.startClientX = event.deltaX;
                this.isTouchEventStart = true;
                this.isMouseEventStart = false;
            }
            if (this.isMouseEventStart || this.isTouchEventStart) {
                this.currentHandlerIndex = handlerIndex;
                this.startPleft = this.sliderModel[handlerIndex];
                this.startPRight = this.sliderModel[handlerIndex + 1];
                this.isHandlerActive = true;
            }
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    handlerSliding(event) {
        if ((this.isMouseEventStart && event.clientX) || (this.isTouchEventStart && event.deltaX)) {
            const /** @type {?} */ movedX = Math.round(((event.clientX || event.deltaX) - this.startClientX) / this.sliderWidth * this.totalDiff);
            const /** @type {?} */ nextPLeft = this.startPleft + movedX;
            const /** @type {?} */ nextPRight = this.startPRight - movedX;
            if (nextPLeft >= 0 && nextPRight >= 0) {
                this.setModelValue(this.currentHandlerIndex, nextPLeft);
                this.setModelValue(this.currentHandlerIndex + 1, nextPRight);
                this.setHandlerPosition();
            }
        }
    }
}
NpnSliderComponent.decorators = [
    { type: Component, args: [{
                selector: 'npn-slider',
                template: `<!--npn-slider template-->
<div class="slider" [class.disabled]="isDisabled">
  <div class="bar" (mousemove)="handlerSliding($event)" (panmove)="handlerSliding($event)">
    <span class="left-handle" [ngClass]="{'active': isHandlerActive && currentHandlerIndex === handlerIndex.left,
                      'last-active': currentHandlerIndex === handlerIndex.left
                    }"
      [style.left.%]="handlerX[handlerIndex.left]" (mousedown)="setHandlerActive($event, handlerIndex.left)" (panstart)="setHandlerActive($event, handlerIndex.left)">
      <span *ngIf="!hideTooltip" class="handle-tooltip">{{currentValues[handlerIndex.left]}}</span>
    </span>
    <div class="filler">
      <div class="step-indicators">
        <span *ngFor="let stepPos of stepIndicatorPositions" [style.left.px]="stepPos"></span>
      </div>
      <span *ngIf="multiRange" [style.left.%]="handlerX[0]" [style.width.%]="handlerX[handlerIndex.right] - handlerX[handlerIndex.left]"></span>
      <span *ngIf="!multiRange" [style.left.%]="0" [style.width.%]="handlerX[0]"></span>
    </div>
    <span *ngIf="multiRange" class="right-handle" [ngClass]="{'active': isHandlerActive && currentHandlerIndex === handlerIndex.right,
                      'last-active': currentHandlerIndex === handlerIndex.right
                    }"
      [style.left.%]="handlerX[handlerIndex.right]" (mousedown)="setHandlerActive($event, handlerIndex.right)"
      (panstart)="setHandlerActive($event, handlerIndex.right)">
      <span *ngIf="!hideTooltip" class="handle-tooltip">{{currentValues[handlerIndex.right]}}</span>
    </span>
  </div>
  <div class="values" *ngIf="!hideValues">
    <span>{{initValues[handlerIndex.left]}}</span>
    <span>{{initValues[handlerIndex.right]}}</span>
  </div>
</div>
`,
                styles: [`.slider,.slider *{box-sizing:border-box}.slider{display:block;width:100%;height:30px;padding:4px 10px;cursor:default;font-size:12px}.slider .bar{width:100%;background:#e8e8e8;height:10px;position:relative;border-radius:5px;box-shadow:inset 1px 1px 5px #bababa}.slider .bar>span.left-handle,.slider .bar>span.right-handle{display:inline-block;width:22px;height:22px;background:#bedcb2;border:7px solid #71b357;border-radius:50%;position:absolute;top:-7px;margin-left:-10px;z-index:1;cursor:pointer;transition:left .2s ease}.slider .bar>span.left-handle.last-active,.slider .bar>span.right-handle.last-active{z-index:2}.slider .bar>span.left-handle .handle-tooltip,.slider .bar>span.right-handle .handle-tooltip{display:block;position:absolute;top:-34px;left:-14px;border:1px solid #8fc37a;border-radius:4px;padding:1px 4px;min-width:20px;text-align:center;background:#d9ebd2;color:#71b357;font-weight:700;transition:opacity .2s ease;opacity:0}.slider .bar>span.left-handle .handle-tooltip:before,.slider .bar>span.right-handle .handle-tooltip:before{content:"";border:5px solid transparent;border-top-color:#8fc37a;position:absolute;top:104%;left:33%}.slider .bar>span.left-handle .handle-tooltip:after,.slider .bar>span.right-handle .handle-tooltip:after{content:"";border:5px solid transparent;border-top-color:#d9ebd2;position:absolute;top:100%;left:33%}.slider .bar>span.left-handle.active>.handle-tooltip,.slider .bar>span.left-handle:hover>.handle-tooltip,.slider .bar>span.right-handle.active>.handle-tooltip,.slider .bar>span.right-handle:hover>.handle-tooltip{opacity:1}.slider .bar div.filler{display:block;width:100%;height:100%;position:relative;overflow:hidden;border-radius:5px;border:1px solid #bedcb2}.slider .bar div.filler>span{display:inline-block;height:100%;position:absolute;top:0;background:#bedcb2;transition:all .2s ease}.slider .bar div.filler>div.step-indicators{width:100%;height:100%;position:relative}.slider .bar div.filler>div.step-indicators>span{width:1px;display:inline-block;height:10px;background:#71b357;position:absolute;left:0}.slider .values{display:block;font-weight:700;margin-top:4px;width:102%;margin-left:-1%;color:#908f90}.slider .values span:first-child{float:left}.slider .values span:last-child{float:right}.slider.disabled{opacity:.4}.slider.disabled .bar{box-shadow:none!important}.slider.disabled .bar>span.left-handle,.slider.disabled .bar>span.right-handle{cursor:not-allowed}.slider.disabled .bar>span.left-handle .handle-tooltip,.slider.disabled .bar>span.right-handle .handle-tooltip{display:none}`]
            },] },
];
/** @nocollapse */
NpnSliderComponent.ctorParameters = () => [
    { type: ElementRef }
];
NpnSliderComponent.propDecorators = {
    setMinValues: [{ type: Input, args: ['min',] }],
    setMaxValues: [{ type: Input, args: ['max',] }],
    setMinSelectedValues: [{ type: Input, args: ['minSelected',] }],
    setMaxSelectedValues: [{ type: Input, args: ['maxSelected',] }],
    stepValue: [{ type: Input, args: ['step',] }],
    showStepIndicator: [{ type: Input }],
    multiRange: [{ type: Input }],
    setHideTooltip: [{ type: Input, args: ['hide-tooltip',] }],
    setHideValues: [{ type: Input, args: ['hide-values',] }],
    setDisabled: [{ type: Input, args: ['disabled',] }],
    onChange: [{ type: Output }],
    setHandlerActiveOff: [{ type: HostListener, args: ['document:mouseup',] }, { type: HostListener, args: ['document:panend',] }]
};
function NpnSliderComponent_tsickle_Closure_declarations() {
    /** @type {?} */
    NpnSliderComponent.prototype.sliderModel;
    /** @type {?} */
    NpnSliderComponent.prototype.step;
    /** @type {?} */
    NpnSliderComponent.prototype.sliderWidth;
    /** @type {?} */
    NpnSliderComponent.prototype.totalDiff;
    /** @type {?} */
    NpnSliderComponent.prototype.startClientX;
    /** @type {?} */
    NpnSliderComponent.prototype.startPleft;
    /** @type {?} */
    NpnSliderComponent.prototype.startPRight;
    /** @type {?} */
    NpnSliderComponent.prototype.minValue;
    /** @type {?} */
    NpnSliderComponent.prototype.maxValue;
    /** @type {?} */
    NpnSliderComponent.prototype.minSelected;
    /** @type {?} */
    NpnSliderComponent.prototype.maxSelected;
    /** @type {?} */
    NpnSliderComponent.prototype.sliderInitiated;
    /** @type {?} */
    NpnSliderComponent.prototype.initValues;
    /** @type {?} */
    NpnSliderComponent.prototype.currentValues;
    /** @type {?} */
    NpnSliderComponent.prototype.handlerX;
    /** @type {?} */
    NpnSliderComponent.prototype.isHandlerActive;
    /** @type {?} */
    NpnSliderComponent.prototype.isTouchEventStart;
    /** @type {?} */
    NpnSliderComponent.prototype.isMouseEventStart;
    /** @type {?} */
    NpnSliderComponent.prototype.currentHandlerIndex;
    /** @type {?} */
    NpnSliderComponent.prototype.stepIndicatorPositions;
    /** @type {?} */
    NpnSliderComponent.prototype.isDisabled;
    /** @type {?} */
    NpnSliderComponent.prototype.hideTooltip;
    /** @type {?} */
    NpnSliderComponent.prototype.hideValues;
    /** @type {?} */
    NpnSliderComponent.prototype.handlerIndex;
    /** @type {?} */
    NpnSliderComponent.prototype.showStepIndicator;
    /** @type {?} */
    NpnSliderComponent.prototype.multiRange;
    /** @type {?} */
    NpnSliderComponent.prototype.onChange;
    /** @type {?} */
    NpnSliderComponent.prototype.el;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnBuLXNsaWRlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9ucG4tc2xpZGVyLyIsInNvdXJjZXMiOlsibGliL25wbi1zbGlkZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUN0QyxVQUFVLEVBQVUsWUFBWSxFQUNqQyxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3hDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBb0MxRCxNQUFNLHlCQUEwQixTQUFRLFNBQVM7Ozs7SUE0Qi9DLFlBQW9CLEVBQWM7UUFDaEMsS0FBSyxFQUFFLENBQUM7UUFEVSxPQUFFLEdBQUYsRUFBRSxDQUFZOzJCQTNCWixDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO29CQUNoQixDQUFDOzJCQUNNLENBQUM7eUJBQ0gsQ0FBQzs0QkFDRSxDQUFDOzBCQUNILENBQUM7MkJBQ0EsQ0FBQzsrQkFLRyxLQUFLOzBCQUVELEVBQUU7NkJBQ0MsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUNYLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQzsrQkFDVCxLQUFLO2lDQUNILEtBQUs7aUNBQ0wsS0FBSzttQ0FDSCxDQUFDO3NDQUNFLEVBQUU7MEJBQ2QsS0FBSzsyQkFDSixLQUFLOzBCQUNOLEtBQUs7NEJBRUgsaUJBQWlCO2lDQXdDVixLQUFLOzBCQUNaLElBQUk7d0JBZUwsSUFBSSxZQUFZLEVBQVk7S0FwRGhEOzs7OztJQUVELElBQ0ksWUFBWSxDQUFDLEtBQWE7UUFDNUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2xCLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FB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O3VCQUtoQixNQUFNO2tDQW9KTixZQUFZLFNBQUMsa0JBQWtCLGNBQy9CLFlBQVksU0FBQyxpQkFBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENvbXBvbmVudCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLFxyXG4gIEVsZW1lbnRSZWYsIE9uSW5pdCwgSG9zdExpc3RlbmVyLCBTaW1wbGVDaGFuZ2VzLCBPbkNoYW5nZXNcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVXRpbGl0aWVzIH0gZnJvbSAnLi91dGlsaXRpZXMnO1xyXG5pbXBvcnQgeyBTbGlkZXJIYW5kbGVyRW51bSB9IGZyb20gJy4vc2xpZGVyLWhhbmRsZXIuZW51bSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ25wbi1zbGlkZXInLFxyXG4gIHRlbXBsYXRlOiBgPCEtLW5wbi1zbGlkZXIgdGVtcGxhdGUtLT5cclxuPGRpdiBjbGFzcz1cInNsaWRlclwiIFtjbGFzcy5kaXNhYmxlZF09XCJpc0Rpc2FibGVkXCI+XHJcbiAgPGRpdiBjbGFzcz1cImJhclwiIChtb3VzZW1vdmUpPVwiaGFuZGxlclNsaWRpbmcoJGV2ZW50KVwiIChwYW5tb3ZlKT1cImhhbmRsZXJTbGlkaW5nKCRldmVudClcIj5cclxuICAgIDxzcGFuIGNsYXNzPVwibGVmdC1oYW5kbGVcIiBbbmdDbGFzc109XCJ7J2FjdGl2ZSc6IGlzSGFuZGxlckFjdGl2ZSAmJiBjdXJyZW50SGFuZGxlckluZGV4ID09PSBoYW5kbGVySW5kZXgubGVmdCxcclxuICAgICAgICAgICAgICAgICAgICAgICdsYXN0LWFjdGl2ZSc6IGN1cnJlbnRIYW5kbGVySW5kZXggPT09IGhhbmRsZXJJbmRleC5sZWZ0XHJcbiAgICAgICAgICAgICAgICAgICAgfVwiXHJcbiAgICAgIFtzdHlsZS5sZWZ0LiVdPVwiaGFuZGxlclhbaGFuZGxlckluZGV4LmxlZnRdXCIgKG1vdXNlZG93bik9XCJzZXRIYW5kbGVyQWN0aXZlKCRldmVudCwgaGFuZGxlckluZGV4LmxlZnQpXCIgKHBhbnN0YXJ0KT1cInNldEhhbmRsZXJBY3RpdmUoJGV2ZW50LCBoYW5kbGVySW5kZXgubGVmdClcIj5cclxuICAgICAgPHNwYW4gKm5nSWY9XCIhaGlkZVRvb2x0aXBcIiBjbGFzcz1cImhhbmRsZS10b29sdGlwXCI+e3tjdXJyZW50VmFsdWVzW2hhbmRsZXJJbmRleC5sZWZ0XX19PC9zcGFuPlxyXG4gICAgPC9zcGFuPlxyXG4gICAgPGRpdiBjbGFzcz1cImZpbGxlclwiPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwic3RlcC1pbmRpY2F0b3JzXCI+XHJcbiAgICAgICAgPHNwYW4gKm5nRm9yPVwibGV0IHN0ZXBQb3Mgb2Ygc3RlcEluZGljYXRvclBvc2l0aW9uc1wiIFtzdHlsZS5sZWZ0LnB4XT1cInN0ZXBQb3NcIj48L3NwYW4+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8c3BhbiAqbmdJZj1cIm11bHRpUmFuZ2VcIiBbc3R5bGUubGVmdC4lXT1cImhhbmRsZXJYWzBdXCIgW3N0eWxlLndpZHRoLiVdPVwiaGFuZGxlclhbaGFuZGxlckluZGV4LnJpZ2h0XSAtIGhhbmRsZXJYW2hhbmRsZXJJbmRleC5sZWZ0XVwiPjwvc3Bhbj5cclxuICAgICAgPHNwYW4gKm5nSWY9XCIhbXVsdGlSYW5nZVwiIFtzdHlsZS5sZWZ0LiVdPVwiMFwiIFtzdHlsZS53aWR0aC4lXT1cImhhbmRsZXJYWzBdXCI+PC9zcGFuPlxyXG4gICAgPC9kaXY+XHJcbiAgICA8c3BhbiAqbmdJZj1cIm11bHRpUmFuZ2VcIiBjbGFzcz1cInJpZ2h0LWhhbmRsZVwiIFtuZ0NsYXNzXT1cInsnYWN0aXZlJzogaXNIYW5kbGVyQWN0aXZlICYmIGN1cnJlbnRIYW5kbGVySW5kZXggPT09IGhhbmRsZXJJbmRleC5yaWdodCxcclxuICAgICAgICAgICAgICAgICAgICAgICdsYXN0LWFjdGl2ZSc6IGN1cnJlbnRIYW5kbGVySW5kZXggPT09IGhhbmRsZXJJbmRleC5yaWdodFxyXG4gICAgICAgICAgICAgICAgICAgIH1cIlxyXG4gICAgICBbc3R5bGUubGVmdC4lXT1cImhhbmRsZXJYW2hhbmRsZXJJbmRleC5yaWdodF1cIiAobW91c2Vkb3duKT1cInNldEhhbmRsZXJBY3RpdmUoJGV2ZW50LCBoYW5kbGVySW5kZXgucmlnaHQpXCJcclxuICAgICAgKHBhbnN0YXJ0KT1cInNldEhhbmRsZXJBY3RpdmUoJGV2ZW50LCBoYW5kbGVySW5kZXgucmlnaHQpXCI+XHJcbiAgICAgIDxzcGFuICpuZ0lmPVwiIWhpZGVUb29sdGlwXCIgY2xhc3M9XCJoYW5kbGUtdG9vbHRpcFwiPnt7Y3VycmVudFZhbHVlc1toYW5kbGVySW5kZXgucmlnaHRdfX08L3NwYW4+XHJcbiAgICA8L3NwYW4+XHJcbiAgPC9kaXY+XHJcbiAgPGRpdiBjbGFzcz1cInZhbHVlc1wiICpuZ0lmPVwiIWhpZGVWYWx1ZXNcIj5cclxuICAgIDxzcGFuPnt7aW5pdFZhbHVlc1toYW5kbGVySW5kZXgubGVmdF19fTwvc3Bhbj5cclxuICAgIDxzcGFuPnt7aW5pdFZhbHVlc1toYW5kbGVySW5kZXgucmlnaHRdfX08L3NwYW4+XHJcbiAgPC9kaXY+XHJcbjwvZGl2PlxyXG5gLFxyXG4gIHN0eWxlczogW2Auc2xpZGVyLC5zbGlkZXIgKntib3gtc2l6aW5nOmJvcmRlci1ib3h9LnNsaWRlcntkaXNwbGF5OmJsb2NrO3dpZHRoOjEwMCU7aGVpZ2h0OjMwcHg7cGFkZGluZzo0cHggMTBweDtjdXJzb3I6ZGVmYXVsdDtmb250LXNpemU6MTJweH0uc2xpZGVyIC5iYXJ7d2lkdGg6MTAwJTtiYWNrZ3JvdW5kOiNlOGU4ZTg7aGVpZ2h0OjEwcHg7cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyLXJhZGl1czo1cHg7Ym94LXNoYWRvdzppbnNldCAxcHggMXB4IDVweCAjYmFiYWJhfS5zbGlkZXIgLmJhcj5zcGFuLmxlZnQtaGFuZGxlLC5zbGlkZXIgLmJhcj5zcGFuLnJpZ2h0LWhhbmRsZXtkaXNwbGF5OmlubGluZS1ibG9jazt3aWR0aDoyMnB4O2hlaWdodDoyMnB4O2JhY2tncm91bmQ6I2JlZGNiMjtib3JkZXI6N3B4IHNvbGlkICM3MWIzNTc7Ym9yZGVyLXJhZGl1czo1MCU7cG9zaXRpb246YWJzb2x1dGU7dG9wOi03cHg7bWFyZ2luLWxlZnQ6LTEwcHg7ei1pbmRleDoxO2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246bGVmdCAuMnMgZWFzZX0uc2xpZGVyIC5iYXI+c3Bhbi5sZWZ0LWhhbmRsZS5sYXN0LWFjdGl2ZSwuc2xpZGVyIC5iYXI+c3Bhbi5yaWdodC1oYW5kbGUubGFzdC1hY3RpdmV7ei1pbmRleDoyfS5zbGlkZXIgLmJhcj5zcGFuLmxlZnQtaGFuZGxlIC5oYW5kbGUtdG9vbHRpcCwuc2xpZGVyIC5iYXI+c3Bhbi5yaWdodC1oYW5kbGUgLmhhbmRsZS10b29sdGlwe2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7dG9wOi0zNHB4O2xlZnQ6LTE0cHg7Ym9yZGVyOjFweCBzb2xpZCAjOGZjMzdhO2JvcmRlci1yYWRpdXM6NHB4O3BhZGRpbmc6MXB4IDRweDttaW4td2lkdGg6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjtiYWNrZ3JvdW5kOiNkOWViZDI7Y29sb3I6IzcxYjM1Nztmb250LXdlaWdodDo3MDA7dHJhbnNpdGlvbjpvcGFjaXR5IC4ycyBlYXNlO29wYWNpdHk6MH0uc2xpZGVyIC5iYXI+c3Bhbi5sZWZ0LWhhbmRsZSAuaGFuZGxlLXRvb2x0aXA6YmVmb3JlLC5zbGlkZXIgLmJhcj5zcGFuLnJpZ2h0LWhhbmRsZSAuaGFuZGxlLXRvb2x0aXA6YmVmb3Jle2NvbnRlbnQ6XCJcIjtib3JkZXI6NXB4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci10b3AtY29sb3I6IzhmYzM3YTtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MTA0JTtsZWZ0OjMzJX0uc2xpZGVyIC5iYXI+c3Bhbi5sZWZ0LWhhbmRsZSAuaGFuZGxlLXRvb2x0aXA6YWZ0ZXIsLnNsaWRlciAuYmFyPnNwYW4ucmlnaHQtaGFuZGxlIC5oYW5kbGUtdG9vbHRpcDphZnRlcntjb250ZW50OlwiXCI7Ym9yZGVyOjVweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItdG9wLWNvbG9yOiNkOWViZDI7cG9zaXRpb246YWJzb2x1dGU7dG9wOjEwMCU7bGVmdDozMyV9LnNsaWRlciAuYmFyPnNwYW4ubGVmdC1oYW5kbGUuYWN0aXZlPi5oYW5kbGUtdG9vbHRpcCwuc2xpZGVyIC5iYXI+c3Bhbi5sZWZ0LWhhbmRsZTpob3Zlcj4uaGFuZGxlLXRvb2x0aXAsLnNsaWRlciAuYmFyPnNwYW4ucmlnaHQtaGFuZGxlLmFjdGl2ZT4uaGFuZGxlLXRvb2x0aXAsLnNsaWRlciAuYmFyPnNwYW4ucmlnaHQtaGFuZGxlOmhvdmVyPi5oYW5kbGUtdG9vbHRpcHtvcGFjaXR5OjF9LnNsaWRlciAuYmFyIGRpdi5maWxsZXJ7ZGlzcGxheTpibG9jazt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3Bvc2l0aW9uOnJlbGF0aXZlO292ZXJmbG93OmhpZGRlbjtib3JkZXItcmFkaXVzOjVweDtib3JkZXI6MXB4IHNvbGlkICNiZWRjYjJ9LnNsaWRlciAuYmFyIGRpdi5maWxsZXI+c3BhbntkaXNwbGF5OmlubGluZS1ibG9jaztoZWlnaHQ6MTAwJTtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtiYWNrZ3JvdW5kOiNiZWRjYjI7dHJhbnNpdGlvbjphbGwgLjJzIGVhc2V9LnNsaWRlciAuYmFyIGRpdi5maWxsZXI+ZGl2LnN0ZXAtaW5kaWNhdG9yc3t3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3Bvc2l0aW9uOnJlbGF0aXZlfS5zbGlkZXIgLmJhciBkaXYuZmlsbGVyPmRpdi5zdGVwLWluZGljYXRvcnM+c3Bhbnt3aWR0aDoxcHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7aGVpZ2h0OjEwcHg7YmFja2dyb3VuZDojNzFiMzU3O3Bvc2l0aW9uOmFic29sdXRlO2xlZnQ6MH0uc2xpZGVyIC52YWx1ZXN7ZGlzcGxheTpibG9jaztmb250LXdlaWdodDo3MDA7bWFyZ2luLXRvcDo0cHg7d2lkdGg6MTAyJTttYXJnaW4tbGVmdDotMSU7Y29sb3I6IzkwOGY5MH0uc2xpZGVyIC52YWx1ZXMgc3BhbjpmaXJzdC1jaGlsZHtmbG9hdDpsZWZ0fS5zbGlkZXIgLnZhbHVlcyBzcGFuOmxhc3QtY2hpbGR7ZmxvYXQ6cmlnaHR9LnNsaWRlci5kaXNhYmxlZHtvcGFjaXR5Oi40fS5zbGlkZXIuZGlzYWJsZWQgLmJhcntib3gtc2hhZG93Om5vbmUhaW1wb3J0YW50fS5zbGlkZXIuZGlzYWJsZWQgLmJhcj5zcGFuLmxlZnQtaGFuZGxlLC5zbGlkZXIuZGlzYWJsZWQgLmJhcj5zcGFuLnJpZ2h0LWhhbmRsZXtjdXJzb3I6bm90LWFsbG93ZWR9LnNsaWRlci5kaXNhYmxlZCAuYmFyPnNwYW4ubGVmdC1oYW5kbGUgLmhhbmRsZS10b29sdGlwLC5zbGlkZXIuZGlzYWJsZWQgLmJhcj5zcGFuLnJpZ2h0LWhhbmRsZSAuaGFuZGxlLXRvb2x0aXB7ZGlzcGxheTpub25lfWBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOcG5TbGlkZXJDb21wb25lbnQgZXh0ZW5kcyBVdGlsaXRpZXMgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XHJcbiAgcHJpdmF0ZSBzbGlkZXJNb2RlbCA9IFswLCAwLCAwXTtcclxuICBwcml2YXRlIHN0ZXAgPSAxO1xyXG4gIHByaXZhdGUgc2xpZGVyV2lkdGggPSAwO1xyXG4gIHByaXZhdGUgdG90YWxEaWZmID0gMDtcclxuICBwcml2YXRlIHN0YXJ0Q2xpZW50WCA9IDA7XHJcbiAgcHJpdmF0ZSBzdGFydFBsZWZ0ID0gMDtcclxuICBwcml2YXRlIHN0YXJ0UFJpZ2h0ID0gMDtcclxuICBwcml2YXRlIG1pblZhbHVlOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBtYXhWYWx1ZTogbnVtYmVyO1xyXG4gIHByaXZhdGUgbWluU2VsZWN0ZWQ6IG51bWJlcjtcclxuICBwcml2YXRlIG1heFNlbGVjdGVkOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBzbGlkZXJJbml0aWF0ZWQgPSBmYWxzZTtcclxuXHJcbiAgcHVibGljIGluaXRWYWx1ZXM6IG51bWJlcltdID0gW107XHJcbiAgcHVibGljIGN1cnJlbnRWYWx1ZXM6IG51bWJlcltdID0gWzAsIDBdO1xyXG4gIHB1YmxpYyBoYW5kbGVyWDogbnVtYmVyW10gPSBbMCwgMF07XHJcbiAgcHVibGljIGlzSGFuZGxlckFjdGl2ZSA9IGZhbHNlO1xyXG4gIHB1YmxpYyBpc1RvdWNoRXZlbnRTdGFydCA9IGZhbHNlO1xyXG4gIHB1YmxpYyBpc01vdXNlRXZlbnRTdGFydCA9IGZhbHNlO1xyXG4gIHB1YmxpYyBjdXJyZW50SGFuZGxlckluZGV4ID0gMDtcclxuICBwdWJsaWMgc3RlcEluZGljYXRvclBvc2l0aW9ucyA9IFtdO1xyXG4gIHB1YmxpYyBpc0Rpc2FibGVkID0gZmFsc2U7XHJcbiAgcHVibGljIGhpZGVUb29sdGlwID0gZmFsc2U7XHJcbiAgcHVibGljIGhpZGVWYWx1ZXMgPSBmYWxzZTtcclxuXHJcbiAgcHVibGljIGhhbmRsZXJJbmRleCA9IFNsaWRlckhhbmRsZXJFbnVtO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsOiBFbGVtZW50UmVmKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gIH1cclxuXHJcbiAgQElucHV0KCdtaW4nKVxyXG4gIHNldCBzZXRNaW5WYWx1ZXModmFsdWU6IG51bWJlcikge1xyXG4gICAgaWYgKCFpc05hTih2YWx1ZSkpIHtcclxuICAgICAgdGhpcy5taW5WYWx1ZSA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBASW5wdXQoJ21heCcpXHJcbiAgc2V0IHNldE1heFZhbHVlcyh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICBpZiAoIWlzTmFOKHZhbHVlKSkge1xyXG4gICAgICB0aGlzLm1heFZhbHVlID0gTnVtYmVyKHZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBJbnB1dCgnbWluU2VsZWN0ZWQnKVxyXG4gIHNldCBzZXRNaW5TZWxlY3RlZFZhbHVlcyh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICBpZiAoIWlzTmFOKHZhbHVlKSAmJiB0aGlzLm1pblNlbGVjdGVkICE9PSBOdW1iZXIodmFsdWUpKSB7XHJcbiAgICAgIHRoaXMubWluU2VsZWN0ZWQgPSBOdW1iZXIodmFsdWUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQElucHV0KCdtYXhTZWxlY3RlZCcpXHJcbiAgc2V0IHNldE1heFNlbGVjdGVkVmFsdWVzKHZhbHVlOiBudW1iZXIpIHtcclxuICAgIGlmICghaXNOYU4odmFsdWUpICYmIHRoaXMubWF4U2VsZWN0ZWQgIT09IE51bWJlcih2YWx1ZSkpIHtcclxuICAgICAgdGhpcy5tYXhTZWxlY3RlZCA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIEBJbnB1dCgnc3RlcCcpXHJcbiAgc2V0IHN0ZXBWYWx1ZSh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICBpZiAoIWlzTmFOKHZhbHVlKSkge1xyXG4gICAgICB0aGlzLnN0ZXAgPSBOdW1iZXIodmFsdWUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQElucHV0KCkgc2hvd1N0ZXBJbmRpY2F0b3IgPSBmYWxzZTtcclxuICBASW5wdXQoKSBtdWx0aVJhbmdlID0gdHJ1ZTtcclxuICBASW5wdXQoJ2hpZGUtdG9vbHRpcCcpXHJcbiAgc2V0IHNldEhpZGVUb29sdGlwKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLmhpZGVUb29sdGlwID0gdGhpcy50b0Jvb2xlYW4odmFsdWUpO1xyXG4gIH1cclxuICBASW5wdXQoJ2hpZGUtdmFsdWVzJylcclxuICBzZXQgc2V0SGlkZVZhbHVlcyh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgdGhpcy5oaWRlVmFsdWVzID0gdGhpcy50b0Jvb2xlYW4odmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgQElucHV0KCdkaXNhYmxlZCcpXHJcbiAgc2V0IHNldERpc2FibGVkKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuaXNEaXNhYmxlZCA9IHRoaXMudG9Cb29sZWFuKHZhbHVlLCAnZGlzYWJsZWQnKTtcclxuICB9XHJcblxyXG4gIEBPdXRwdXQoKSBvbkNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8bnVtYmVyW10+KCk7XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5pbml0aWFsaXplU2xpZGVyKCk7XHJcbiAgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICBpZiAodGhpcy5zbGlkZXJJbml0aWF0ZWQpIHtcclxuICAgICAgaWYgKCF0aGlzLmlzTnVsbE9yRW1wdHkoY2hhbmdlcy5zZXRNaW5TZWxlY3RlZFZhbHVlcylcclxuICAgICAgICAmJiBjaGFuZ2VzLnNldE1pblNlbGVjdGVkVmFsdWVzLnByZXZpb3VzVmFsdWUgPT09IGNoYW5nZXMuc2V0TWluU2VsZWN0ZWRWYWx1ZXMuY3VycmVudFZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghdGhpcy5pc051bGxPckVtcHR5KGNoYW5nZXMuc2V0TWF4U2VsZWN0ZWRWYWx1ZXMpXHJcbiAgICAgICAgJiYgY2hhbmdlcy5zZXRNYXhTZWxlY3RlZFZhbHVlcy5wcmV2aW91c1ZhbHVlID09PSBjaGFuZ2VzLnNldE1heFNlbGVjdGVkVmFsdWVzLmN1cnJlbnRWYWx1ZSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnJlc2V0TW9kZWwoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIGluaXRhaWxpemUgZW50aXJlIFNsaWRlciovXHJcbiAgcHVibGljIGluaXRpYWxpemVTbGlkZXIoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBUYWtpbmcgd2lkdGggb2Ygc2xpZGVyIGJhciBlbGVtZW50LlxyXG4gICAgICB0aGlzLnNsaWRlcldpZHRoID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLm9mZnNldFdpZHRoO1xyXG4gICAgICB0aGlzLnJlc2V0TW9kZWwoKTtcclxuICAgICAgdGhpcy5zbGlkZXJJbml0aWF0ZWQgPSB0cnVlO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLypNZXRob2QgdG8gaW5pdGlhbGl6ZSB2YXJpYWJsZXMgYW5kIG1vZGVsIHZhbHVlcyAqL1xyXG4gIHByaXZhdGUgcmVzZXRNb2RlbCgpIHtcclxuICAgIHRoaXMudmFsaWRhdGVTbGlkZXJWYWx1ZXMoKTtcclxuICAgIC8vIFNldHRpbmcgdGhlIG1vZGVsIHZhbHVlc1xyXG4gICAgdGhpcy5zbGlkZXJNb2RlbCA9IFtcclxuICAgICAgdGhpcy5jdXJyZW50VmFsdWVzWzBdIC0gdGhpcy5pbml0VmFsdWVzWzBdLFxyXG4gICAgICB0aGlzLmN1cnJlbnRWYWx1ZXNbMV0gLSB0aGlzLmN1cnJlbnRWYWx1ZXNbMF0sXHJcbiAgICAgIHRoaXMuaW5pdFZhbHVlc1sxXSAtIHRoaXMuY3VycmVudFZhbHVlc1sxXVxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLnRvdGFsRGlmZiA9IHRoaXMuc2xpZGVyTW9kZWwucmVkdWNlKChwcmV2VmFsdWUsIGN1clZhbHVlKSA9PiBwcmV2VmFsdWUgKyBjdXJWYWx1ZSwgMCk7XHJcblxyXG4gICAgLy8gVmFsaWRhdGlvbiBmb3Igc2xpZGVyIHN0ZXBcclxuICAgIGlmICh0aGlzLnRvdGFsRGlmZiAlIHRoaXMuc3RlcCAhPT0gMCkge1xyXG4gICAgICBjb25zdCBuZXdTdGVwID0gdGhpcy5maW5kTmV4dFZhbGlkU3RlcFZhbHVlKHRoaXMudG90YWxEaWZmLCB0aGlzLnN0ZXApO1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0ludmFsaWQgc3RlcCB2YWx1ZSBcIicgKyB0aGlzLnN0ZXAgKyAnXCIgOiBhbmQgdG9vayBcIicgKyBuZXdTdGVwICsgJ1wiIGFzIGRlZmF1bHQgc3RlcCcpO1xyXG4gICAgICB0aGlzLnN0ZXAgPSBuZXdTdGVwO1xyXG4gICAgfVxyXG4gICAgdGhpcy5pbml0aWFsaXplU3RlcEluZGljYXRvcigpO1xyXG4gICAgdGhpcy5zZXRIYW5kbGVyUG9zaXRpb24oKTtcclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIGRvIHZhbGlkYXRpb24gb2YgaW5pdCBhbmQgc2VsZXRlZCByYW5nZSB2YWx1ZXMqL1xyXG4gIHByaXZhdGUgdmFsaWRhdGVTbGlkZXJWYWx1ZXMoKSB7XHJcbiAgICBpZiAodGhpcy5pc051bGxPckVtcHR5KHRoaXMubWluVmFsdWUpIHx8IHRoaXMuaXNOdWxsT3JFbXB0eSh0aGlzLm1heFZhbHVlKSkge1xyXG4gICAgICB0aGlzLnVwZGF0ZUluaXRWYWx1ZXMoWzAsIDBdKTtcclxuICAgICAgdGhpcy51cGRhdGVDdXJyZW50VmFsdWUoWzAsIDBdLCB0cnVlKTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5taW5WYWx1ZSA+IHRoaXMubWF4VmFsdWUpIHtcclxuICAgICAgdGhpcy51cGRhdGVJbml0VmFsdWVzKFswLCAwXSk7XHJcbiAgICAgIHRoaXMudXBkYXRlQ3VycmVudFZhbHVlKFswLCAwXSwgdHJ1ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmluaXRWYWx1ZXMgPSBbdGhpcy5taW5WYWx1ZSwgdGhpcy5tYXhWYWx1ZV07XHJcbiAgICAgIC8qXHJcbiAgICAgICogVmFsaWRhdGlvbiBmb3IgU2VsZWN0ZWQgcmFuZ2UgdmFsdWVzXHJcbiAgICAgICovXHJcbiAgICAgIHRoaXMubWluU2VsZWN0ZWQgPSB0aGlzLmlzTnVsbE9yRW1wdHkodGhpcy5taW5TZWxlY3RlZCkgPyAwIDogdGhpcy5taW5TZWxlY3RlZDtcclxuICAgICAgdGhpcy5tYXhTZWxlY3RlZCA9IHRoaXMuaXNOdWxsT3JFbXB0eSh0aGlzLm1heFNlbGVjdGVkKSA/IDAgOiB0aGlzLm1heFNlbGVjdGVkO1xyXG5cclxuICAgICAgaWYgKHRoaXMubWluU2VsZWN0ZWQgPCB0aGlzLm1pblZhbHVlIHx8IHRoaXMubWluU2VsZWN0ZWQgPiB0aGlzLm1heFZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5taW5TZWxlY3RlZCA9IHRoaXMubWluVmFsdWU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubWF4U2VsZWN0ZWQgPCB0aGlzLm1pblZhbHVlIHx8IHRoaXMubWF4U2VsZWN0ZWQgPiB0aGlzLm1heFZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5tYXhTZWxlY3RlZCA9IHRoaXMubWF4VmFsdWU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubWluU2VsZWN0ZWQgPiB0aGlzLm1heFNlbGVjdGVkKSB7XHJcbiAgICAgICAgdGhpcy5taW5TZWxlY3RlZCA9IHRoaXMubWluVmFsdWU7XHJcbiAgICAgICAgdGhpcy5tYXhTZWxlY3RlZCA9IHRoaXMubWF4VmFsdWU7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy51cGRhdGVDdXJyZW50VmFsdWUoW3RoaXMubWluU2VsZWN0ZWQsIHRoaXMubWF4U2VsZWN0ZWRdLCB0cnVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIGFkZCBzdGVwIGluaWRpY2F0b3IgdG8gc2xpZGVyICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplU3RlcEluZGljYXRvcigpIHtcclxuICAgIGlmICh0aGlzLnNob3dTdGVwSW5kaWNhdG9yKSB7XHJcbiAgICAgIHRoaXMuc3RlcEluZGljYXRvclBvc2l0aW9ucy5sZW5ndGggPSAwO1xyXG4gICAgICBjb25zdCBudW1PZlN0ZXBJbmRpY2F0b3JzID0gdGhpcy50b3RhbERpZmYgLyB0aGlzLnN0ZXA7XHJcbiAgICAgIGlmICh0aGlzLnNsaWRlcldpZHRoIC8gbnVtT2ZTdGVwSW5kaWNhdG9ycyA+PSAxMCkge1xyXG4gICAgICAgIGNvbnN0IGluY3JlbWVudCA9IHRoaXMuc2xpZGVyV2lkdGggLyBudW1PZlN0ZXBJbmRpY2F0b3JzO1xyXG4gICAgICAgIGxldCBsZWZ0UG9zaXRpb24gPSBpbmNyZW1lbnQ7XHJcbiAgICAgICAgd2hpbGUgKHRoaXMuc3RlcEluZGljYXRvclBvc2l0aW9ucy5sZW5ndGggPCBudW1PZlN0ZXBJbmRpY2F0b3JzIC0gMSkge1xyXG4gICAgICAgICAgdGhpcy5zdGVwSW5kaWNhdG9yUG9zaXRpb25zLnB1c2goK2xlZnRQb3NpdGlvbi50b0ZpeGVkKDIpKTtcclxuICAgICAgICAgIGxlZnRQb3NpdGlvbiArPSBpbmNyZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgQXMgJ3N0ZXAnIHZhbHVlIGlzIHRvbyBzbWFsbCBjb21wYXJlZCB0byBtaW4gJiBtYXggdmFsdWUgZGlmZmVyZW5jZSBhbmQgc2xpZGVyIHdpZHRoLFxyXG4gICAgICAgICAgU3RlcCBJbmRpY2F0b3IgY2FuJ3QgYmUgZGlzcGxheWVkIS4gUHJvdmlkZSBzbGlnaHQgbGFyZ2UgdmFsdWUgZm9yICdzdGVwJ2ApO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnN0ZXBJbmRpY2F0b3JQb3NpdGlvbnMubGVuZ3RoID0gMDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIHNldCBjdXJyZW50IHNlbGVjdGVkIHZhbHVlcyAqL1xyXG4gIHByaXZhdGUgdXBkYXRlQ3VycmVudFZhbHVlKGFycmF5VmFsdWU6IG51bWJlcltdLCBwcml2YXRlQ2hhbmdlOiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgIHRoaXMubWluU2VsZWN0ZWQgPSB0aGlzLmN1cnJlbnRWYWx1ZXNbMF0gPSBhcnJheVZhbHVlWzBdO1xyXG4gICAgdGhpcy5tYXhTZWxlY3RlZCA9IHRoaXMuY3VycmVudFZhbHVlc1sxXSA9IGFycmF5VmFsdWVbMV07XHJcbiAgICBpZiAoIXByaXZhdGVDaGFuZ2UpIHtcclxuICAgICAgdGhpcy5vbkNoYW5nZS5lbWl0KCh0aGlzLm11bHRpUmFuZ2UpID8gdGhpcy5jdXJyZW50VmFsdWVzIDogW3RoaXMuY3VycmVudFZhbHVlc1swXV0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLypNZXRob2QgdG8gc2V0IGN1cnJlbnQgc2VsZWN0ZWQgdmFsdWVzICovXHJcbiAgcHJpdmF0ZSB1cGRhdGVJbml0VmFsdWVzKGFycmF5VmFsdWU6IG51bWJlcltdKSB7XHJcbiAgICB0aGlzLm1pblZhbHVlID0gdGhpcy5pbml0VmFsdWVzWzBdID0gYXJyYXlWYWx1ZVswXTtcclxuICAgIHRoaXMubWF4VmFsdWUgPSB0aGlzLmluaXRWYWx1ZXNbMV0gPSBhcnJheVZhbHVlWzFdO1xyXG4gIH1cclxuXHJcbiAgLypNZXRob2QgdG8gc2V0IGhhbmRsZXIgcG9zaXRpb24gKi9cclxuICBwcml2YXRlIHNldEhhbmRsZXJQb3NpdGlvbigpIHtcclxuICAgIGxldCBydW5uaW5nVG90YWwgPSAwO1xyXG4gICAgLy8gVXBkYXRpbmcgc2VsZWN0ZWQgdmFsdWVzIDogY3VycmVudCB2YWx1ZXNcclxuICAgIHRoaXMudXBkYXRlQ3VycmVudFZhbHVlKFtcclxuICAgICAgdGhpcy5pbml0VmFsdWVzWzBdICsgdGhpcy5zbGlkZXJNb2RlbFswXSxcclxuICAgICAgdGhpcy5pbml0VmFsdWVzWzFdIC0gdGhpcy5zbGlkZXJNb2RlbFsyXVxyXG4gICAgXSk7XHJcbiAgICAvKlNldHRpbmcgaGFuZGxlciBwb3NpdGlvbiAqL1xyXG4gICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHRoaXMuc2xpZGVyTW9kZWwubGVuZ3RoIC0gMTsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgIHJ1bm5pbmdUb3RhbCArPSB0aGlzLnNsaWRlck1vZGVsW2ldO1xyXG4gICAgICB0aGlzLmhhbmRsZXJYW2ldID0gKHJ1bm5pbmdUb3RhbCAvIHRoaXMudG90YWxEaWZmKSAqIDEwMDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qTWV0aG9kIHRvIHNldCBtb2RlbCBhcnJheSB2YWx1ZXMgLSB3aWxsIHRyeSB0byByZWZpbmUgdGhlIHZhbHVlcyB1c2luZyBzdGVwICovXHJcbiAgcHJpdmF0ZSBzZXRNb2RlbFZhbHVlKGluZGV4OiBudW1iZXIsIHZhbHVlOiBudW1iZXIpIHtcclxuICAgIGlmICh0aGlzLnN0ZXAgPiAxKSB7XHJcbiAgICAgIHZhbHVlID0gTWF0aC5yb3VuZCh2YWx1ZSAvIHRoaXMuc3RlcCkgKiB0aGlzLnN0ZXA7XHJcbiAgICB9XHJcbiAgICB0aGlzLnNsaWRlck1vZGVsW2luZGV4XSA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgLypNZXRob2QgdG8gZGlzYWJsZSBoYW5kbGVyIG1vdmVtZW50Ki9cclxuICAvKkV4ZWN1dGUgb24gZXZlbnRzOlxyXG4gICogb24tbW91c2V1cFxyXG4gICogb24tcGFuZW5kXHJcbiAgKi9cclxuICBASG9zdExpc3RlbmVyKCdkb2N1bWVudDptb3VzZXVwJylcclxuICBASG9zdExpc3RlbmVyKCdkb2N1bWVudDpwYW5lbmQnKVxyXG4gIHNldEhhbmRsZXJBY3RpdmVPZmYoKSB7XHJcbiAgICB0aGlzLmlzTW91c2VFdmVudFN0YXJ0ID0gZmFsc2U7XHJcbiAgICB0aGlzLmlzVG91Y2hFdmVudFN0YXJ0ID0gZmFsc2U7XHJcbiAgICB0aGlzLmlzSGFuZGxlckFjdGl2ZSA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLypNZXRob2QgdG8gZGV0ZWN0IHN0YXJ0IGRyYWdpbmcgaGFuZGxlciovXHJcbiAgLypFeGVjdXRlIG9uIGV2ZW50czpcclxuICAqIG9uLW1vdXNlZG93blxyXG4gICogb24tcGFuc3RhcnRcclxuICAqL1xyXG4gIHB1YmxpYyBzZXRIYW5kbGVyQWN0aXZlKGV2ZW50OiBhbnksIGhhbmRsZXJJbmRleDogbnVtYmVyKSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKCF0aGlzLmlzRGlzYWJsZWQpIHtcclxuXHJcbiAgICAgIGlmICghdGhpcy5pc051bGxPckVtcHR5KGV2ZW50LmNsaWVudFgpKSB7XHJcbiAgICAgICAgdGhpcy5zdGFydENsaWVudFggPSBldmVudC5jbGllbnRYO1xyXG4gICAgICAgIHRoaXMuaXNNb3VzZUV2ZW50U3RhcnQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuaXNUb3VjaEV2ZW50U3RhcnQgPSBmYWxzZTtcclxuICAgICAgfSBlbHNlIGlmICghdGhpcy5pc051bGxPckVtcHR5KGV2ZW50LmRlbHRhWCkpIHtcclxuICAgICAgICB0aGlzLnN0YXJ0Q2xpZW50WCA9IGV2ZW50LmRlbHRhWDtcclxuICAgICAgICB0aGlzLmlzVG91Y2hFdmVudFN0YXJ0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmlzTW91c2VFdmVudFN0YXJ0ID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuaXNNb3VzZUV2ZW50U3RhcnQgfHwgdGhpcy5pc1RvdWNoRXZlbnRTdGFydCkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEhhbmRsZXJJbmRleCA9IGhhbmRsZXJJbmRleDtcclxuICAgICAgICB0aGlzLnN0YXJ0UGxlZnQgPSB0aGlzLnNsaWRlck1vZGVsW2hhbmRsZXJJbmRleF07XHJcbiAgICAgICAgdGhpcy5zdGFydFBSaWdodCA9IHRoaXMuc2xpZGVyTW9kZWxbaGFuZGxlckluZGV4ICsgMV07XHJcbiAgICAgICAgdGhpcy5pc0hhbmRsZXJBY3RpdmUgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgLypNZXRob2QgdG8gY2FsY3VsYXRlIHNpbGRlciBoYW5kbGVyIG1vdmVtZW50ICovXHJcbiAgLypFeGVjdXRlIG9uIGV2ZW50czpcclxuICAqIG9uLW1vdXNlbW92ZVxyXG4gICogb24tcGFubW92ZVxyXG4gICovXHJcbiAgcHVibGljIGhhbmRsZXJTbGlkaW5nKGV2ZW50OiBhbnkpIHtcclxuICAgIGlmICgodGhpcy5pc01vdXNlRXZlbnRTdGFydCAmJiBldmVudC5jbGllbnRYKSB8fCAodGhpcy5pc1RvdWNoRXZlbnRTdGFydCAmJiBldmVudC5kZWx0YVgpKSB7XHJcbiAgICAgIGNvbnN0IG1vdmVkWCA9IE1hdGgucm91bmQoKChldmVudC5jbGllbnRYIHx8IGV2ZW50LmRlbHRhWCkgLSB0aGlzLnN0YXJ0Q2xpZW50WCkgLyB0aGlzLnNsaWRlcldpZHRoICogdGhpcy50b3RhbERpZmYpO1xyXG4gICAgICBjb25zdCBuZXh0UExlZnQgPSB0aGlzLnN0YXJ0UGxlZnQgKyBtb3ZlZFg7XHJcbiAgICAgIGNvbnN0IG5leHRQUmlnaHQgPSB0aGlzLnN0YXJ0UFJpZ2h0IC0gbW92ZWRYO1xyXG4gICAgICBpZiAobmV4dFBMZWZ0ID49IDAgJiYgbmV4dFBSaWdodCA+PSAwKSB7XHJcbiAgICAgICAgdGhpcy5zZXRNb2RlbFZhbHVlKHRoaXMuY3VycmVudEhhbmRsZXJJbmRleCwgbmV4dFBMZWZ0KTtcclxuICAgICAgICB0aGlzLnNldE1vZGVsVmFsdWUodGhpcy5jdXJyZW50SGFuZGxlckluZGV4ICsgMSwgbmV4dFBSaWdodCk7XHJcbiAgICAgICAgdGhpcy5zZXRIYW5kbGVyUG9zaXRpb24oKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXX0=